<!DOCTYPE html>
<!-- saved from url=(0068)https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/ -->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Urban Heat Island</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="./Urban Heat Island_files/clipboard.min.js"></script>
<script src="./Urban Heat Island_files/quarto.js"></script>
<script src="./Urban Heat Island_files/popper.min.js"></script>
<script src="./Urban Heat Island_files/tippy.umd.min.js"></script>
<script src="./Urban Heat Island_files/anchor.min.js"></script>
<link href="./Urban Heat Island_files/tippy.css" rel="stylesheet">
<link href="./Urban Heat Island_files/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="./Urban Heat Island_files/bootstrap.min.js"></script>
<link href="./Urban Heat Island_files/bootstrap-icons.css" rel="stylesheet">
<link href="./Urban Heat Island_files/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


<style>.ansi-display{font-family:monospace;white-space:pre-wrap;--ansiBlack: #000000;--ansiRed: #cd3131;--ansiGreen: #00BC00;--ansiYellow: #949800;--ansiBlue: #0451a5;--ansiMagenta: #bc05bc;--ansiCyan: #0598bc;--ansiWhite: #555555;--ansiBrightBlack: #666666;--ansiBrightRed: #cd3131;--ansiBrightGreen: #14CE14;--ansiBrightYellow: #b5ba00;--ansiBrightBlue: #0451a5;--ansiBrightMagenta: #bc05bc;--ansiBrightCyan: #0598bc;--ansiBrightWhite: #a5a5a5}.dark-mode .ansi-display{--ansiBlack: #000000;--ansiRed: #cd3131;--ansiGreen: #0DBC79;--ansiYellow: #e5e510;--ansiBlue: #2472c8;--ansiMagenta: #bc3fbc;--ansiCyan: #11a8cd;--ansiWhite: #e5e5e5;--ansiBrightBlack: #666666;--ansiBrightRed: #f14c4c;--ansiBrightGreen: #23d18b;--ansiBrightYellow: #f5f543;--ansiBrightBlue: #3b8eea;--ansiBrightMagenta: #d670d6;--ansiBrightCyan: #29b8db;--ansiBrightWhite: #e5e5e5}@keyframes ansi-displaly-run-blink{50%{opacity:0}}.fui-FluentProvider h2{border-bottom:none;padding-bottom:0}</style><style data-make-styles-bucket="d" data-priority="0"></style><style id="fui-FluentProviderr0"></style></head>

<body class="fullcontent quarto-light" data-tabster="{&quot;root&quot;:{}}">

<i tabindex="0" role="none" data-tabster-dummy="" aria-hidden="true" style="position: fixed; height: 1px; width: 1px; opacity: 0.001; z-index: -1; content-visibility: hidden; top: 0px; left: 0px;"></i><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Urban Heat Island</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">"sf"</span>, <span class="st">"osmdata"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Installing packages into '/cloud/lib/x86_64-pc-linux-gnu-library/4.4'
(as 'lib' is unspecified)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Linking to GEOS 3.8.0, GDAL 3.0.4, PROJ 6.3.1; sf_use_s2() is TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(osmdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Data (c) OpenStreetMap contributors, ODbL 1.0. https://www.openstreetmap.org/copyright</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">"httr"</span>, <span class="st">"jsonlite"</span>, <span class="st">"dplyr"</span>, <span class="st">"ggplot2"</span>, <span class="st">"lubridate"</span>, <span class="st">"R.utils"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Installing packages into '/cloud/lib/x86_64-pc-linux-gnu-library/4.4'
(as 'lib' is unspecified)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb9-2"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span>
<span id="cb9-3"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb13-2"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'lubridate'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    date, intersect, setdiff, union</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb16-1" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb16-2"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">lon =</span> <span class="fl">13.40</span>,   <span class="co"># Longitude for Berlin</span></span>
<span id="cb16-3"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">lat =</span> <span class="fl">52.52</span>    <span class="co"># Latitude for Berlin</span></span>
<span id="cb16-4"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb16-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-5"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb16-6" aria-hidden="true" tabindex="-1"></a>point_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(coords, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"lon"</span>, <span class="st">"lat"</span>), <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb16-7"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb16-8" aria-hidden="true" tabindex="-1"></a>buffer_berlin_sf <span class="ot">&lt;-</span> <span class="fu">st_buffer</span>(point_sf, <span class="at">dist =</span> <span class="dv">500</span>) <span class="co"># Distance in meters</span></span>
<span id="cb16-9"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb16-10" aria-hidden="true" tabindex="-1"></a>bbox <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(buffer_berlin_sf)</span>
<span id="cb16-11"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb16-12" aria-hidden="true" tabindex="-1"></a>building_data <span class="ot">&lt;-</span> <span class="fu">opq</span>(<span class="at">bbox =</span> bbox) <span class="sc">%&gt;%</span> </span>
<span id="cb16-13"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_osm_feature</span>(<span class="at">key =</span> <span class="st">"building"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-14"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb16-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">osmdata_sf</span>()</span>
<span id="cb16-15"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb16-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-16"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb16-16" aria-hidden="true" tabindex="-1"></a>buildings <span class="ot">&lt;-</span> building_data<span class="sc">$</span>osm_polygons</span>
<span id="cb16-17"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb16-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-18"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb16-19"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb16-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> buildings, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb16-20"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb16-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> buffer_berlin_sf, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb16-21"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb16-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb16-22"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb16-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Buildings within 500 meters of the Point of Interest"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in CPL_transform(x, crs, aoi, pipeline, reverse, desired_accuracy, :
GDAL Error 1: PROJ: proj_as_wkt: DatumEnsemble can only be exported to
WKT2:2019
Warning in CPL_transform(x, crs, aoi, pipeline, reverse, desired_accuracy, :
GDAL Error 1: PROJ: proj_as_wkt: DatumEnsemble can only be exported to
WKT2:2019
Warning in CPL_transform(x, crs, aoi, pipeline, reverse, desired_accuracy, :
GDAL Error 1: PROJ: proj_as_wkt: DatumEnsemble can only be exported to
WKT2:2019
Warning in CPL_transform(x, crs, aoi, pipeline, reverse, desired_accuracy, :
GDAL Error 1: PROJ: proj_as_wkt: DatumEnsemble can only be exported to
WKT2:2019
Warning in CPL_transform(x, crs, aoi, pipeline, reverse, desired_accuracy, :
GDAL Error 1: PROJ: proj_as_wkt: DatumEnsemble can only be exported to
WKT2:2019</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Urban Heat Island_files/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb18-1" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb18-2"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">lon =</span> <span class="sc">-</span><span class="fl">87.6298</span>,  <span class="co"># Longitude for Chicago</span></span>
<span id="cb18-3"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">lat =</span> <span class="fl">41.8781</span>    <span class="co"># Latitude for Chicago</span></span>
<span id="cb18-4"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb18-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-5"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb18-6" aria-hidden="true" tabindex="-1"></a>point_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(coords, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"lon"</span>, <span class="st">"lat"</span>), <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb18-7"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb18-8" aria-hidden="true" tabindex="-1"></a>buffer_chicago_sf <span class="ot">&lt;-</span> <span class="fu">st_buffer</span>(point_sf, <span class="at">dist =</span> <span class="dv">500</span>) <span class="co"># Distance in meters</span></span>
<span id="cb18-9"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb18-10" aria-hidden="true" tabindex="-1"></a>bbox <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(buffer_chicago_sf)</span>
<span id="cb18-11"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb18-12" aria-hidden="true" tabindex="-1"></a>building_data <span class="ot">&lt;-</span> <span class="fu">opq</span>(<span class="at">bbox =</span> bbox) <span class="sc">%&gt;%</span> </span>
<span id="cb18-13"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_osm_feature</span>(<span class="at">key =</span> <span class="st">"building"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-14"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">osmdata_sf</span>()</span>
<span id="cb18-15"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb18-16" aria-hidden="true" tabindex="-1"></a>buildings <span class="ot">&lt;-</span> building_data<span class="sc">$</span>osm_polygons</span>
<span id="cb18-17"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb18-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-18"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb18-19"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb18-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> buildings, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb18-20"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb18-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> buffer_chicago_sf, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb18-21"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb18-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb18-22"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb18-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Buildings within 500 meters of the Point of Interest in Chicago"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in CPL_transform(x, crs, aoi, pipeline, reverse, desired_accuracy, :
GDAL Error 1: PROJ: proj_as_wkt: DatumEnsemble can only be exported to
WKT2:2019
Warning in CPL_transform(x, crs, aoi, pipeline, reverse, desired_accuracy, :
GDAL Error 1: PROJ: proj_as_wkt: DatumEnsemble can only be exported to
WKT2:2019
Warning in CPL_transform(x, crs, aoi, pipeline, reverse, desired_accuracy, :
GDAL Error 1: PROJ: proj_as_wkt: DatumEnsemble can only be exported to
WKT2:2019
Warning in CPL_transform(x, crs, aoi, pipeline, reverse, desired_accuracy, :
GDAL Error 1: PROJ: proj_as_wkt: DatumEnsemble can only be exported to
WKT2:2019
Warning in CPL_transform(x, crs, aoi, pipeline, reverse, desired_accuracy, :
GDAL Error 1: PROJ: proj_as_wkt: DatumEnsemble can only be exported to
WKT2:2019</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Urban Heat Island_files/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>############################</p>
<p>For the graphs as above, we can find out buildings and it’s boundaries between two different cities. In case, we might want to use them to define the area we want to talk about and it will be useful in the future which will combine with our own data set.</p>
<p>############################</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">"ggplot2"</span>, <span class="st">"dplyr"</span>, <span class="st">"lubridate"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Installing packages into '/cloud/lib/x86_64-pc-linux-gnu-library/4.4'
(as 'lib' is unspecified)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb22-2"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb22-3"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb22-4"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-5" aria-hidden="true" tabindex="-1"></a>temperature_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb22-6"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">city =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Chicago"</span>, <span class="st">"Berlin"</span>), <span class="at">each =</span> <span class="dv">16</span>),  <span class="co"># Cities</span></span>
<span id="cb22-7"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"06:00"</span>, <span class="st">"12:00"</span>, <span class="st">"18:00"</span>, <span class="st">"00:00"</span>), <span class="dv">8</span>),  <span class="co"># Time</span></span>
<span id="cb22-8"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">date =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="fu">as.Date</span>(<span class="st">"2024-01-01"</span>), <span class="at">by =</span> <span class="st">"1 month"</span>, <span class="at">length.out =</span> <span class="dv">4</span>), <span class="at">times =</span> <span class="dv">4</span>),  <span class="co"># Dates</span></span>
<span id="cb22-9"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">temperature =</span> <span class="fu">c</span>(</span>
<span id="cb22-10"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Chicago temperatures in °F</span></span>
<span id="cb22-11"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="dv">30</span>, <span class="dv">35</span>, <span class="dv">32</span>, <span class="dv">25</span>, <span class="dv">28</span>, <span class="dv">36</span>, <span class="dv">33</span>, <span class="dv">26</span>, <span class="dv">34</span>, <span class="dv">38</span>, <span class="dv">36</span>, <span class="dv">30</span>, <span class="dv">29</span>, <span class="dv">37</span>, <span class="dv">34</span>, <span class="dv">28</span>,</span>
<span id="cb22-12"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Berlin temperatures in °C</span></span>
<span id="cb22-13"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-13" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">3</span></span>
<span id="cb22-14"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-14" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb22-15"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">period =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Day"</span>, <span class="st">"Day"</span>, <span class="st">"Night"</span>, <span class="st">"Night"</span>), <span class="dv">8</span>)  <span class="co"># Day/Night</span></span>
<span id="cb22-16"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-17"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-18"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-18" aria-hidden="true" tabindex="-1"></a>temperature_data <span class="ot">&lt;-</span> temperature_data <span class="sc">%&gt;%</span></span>
<span id="cb22-19"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">floor_date</span>(date, <span class="at">unit =</span> <span class="st">"month"</span>))</span>
<span id="cb22-20"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-21"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-21" aria-hidden="true" tabindex="-1"></a>summary_data <span class="ot">&lt;-</span> temperature_data <span class="sc">%&gt;%</span></span>
<span id="cb22-22"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(city, month, period) <span class="sc">%&gt;%</span></span>
<span id="cb22-23"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">average_temperature =</span> <span class="fu">mean</span>(temperature), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb22-24"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-25"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(summary_data, <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> average_temperature, <span class="at">fill =</span> period)) <span class="sc">+</span></span>
<span id="cb22-26"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb22-27"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>city, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span>  <span class="co"># Separate plots for each city</span></span>
<span id="cb22-28"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb22-29"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Monthly Daytime vs. Nighttime Temperatures: Chicago vs. Berlin"</span>,</span>
<span id="cb22-30"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb22-31"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Temperature"</span>,</span>
<span id="cb22-32"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Period"</span></span>
<span id="cb22-33"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb22-34"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Day"</span> <span class="ot">=</span> <span class="st">"orange"</span>, <span class="st">"Night"</span> <span class="ot">=</span> <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb22-35"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%b %Y"</span>, <span class="at">date_breaks =</span> <span class="st">"1 month"</span>) <span class="sc">+</span></span>
<span id="cb22-36"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb22-37"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb22-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Urban Heat Island_files/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>############################</p>
<p>The above and below graphs are for us to detect the day and night temp differences if you put some temperature data into them. Also it shows different variables which are month, temp and period.</p>
<p>############################</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">"ggplot2"</span>, <span class="st">"dplyr"</span>, <span class="st">"lubridate"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Installing packages into '/cloud/lib/x86_64-pc-linux-gnu-library/4.4'
(as 'lib' is unspecified)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb25-2"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb25-3"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb25-4"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Example temperature data for Chicago and Berlin (in original units)</span></span>
<span id="cb25-6"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-6" aria-hidden="true" tabindex="-1"></a>temperature_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb25-7"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">city =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Chicago"</span>, <span class="st">"Berlin"</span>), <span class="at">each =</span> <span class="dv">16</span>),  <span class="co"># Cities</span></span>
<span id="cb25-8"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"06:00"</span>, <span class="st">"12:00"</span>, <span class="st">"18:00"</span>, <span class="st">"00:00"</span>), <span class="dv">8</span>),  <span class="co"># Time</span></span>
<span id="cb25-9"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">date =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="fu">as.Date</span>(<span class="st">"2024-01-01"</span>), <span class="at">by =</span> <span class="st">"1 month"</span>, <span class="at">length.out =</span> <span class="dv">4</span>), <span class="at">times =</span> <span class="dv">4</span>),  <span class="co"># Dates</span></span>
<span id="cb25-10"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">temperature =</span> <span class="fu">c</span>(</span>
<span id="cb25-11"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Chicago temperatures in °F (to be converted to °C)</span></span>
<span id="cb25-12"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">30</span>, <span class="dv">35</span>, <span class="dv">32</span>, <span class="dv">25</span>, <span class="dv">28</span>, <span class="dv">36</span>, <span class="dv">33</span>, <span class="dv">26</span>, <span class="dv">34</span>, <span class="dv">38</span>, <span class="dv">36</span>, <span class="dv">30</span>, <span class="dv">29</span>, <span class="dv">37</span>, <span class="dv">34</span>, <span class="dv">28</span>,</span>
<span id="cb25-13"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Berlin temperatures in °C</span></span>
<span id="cb25-14"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-14" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">3</span></span>
<span id="cb25-15"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-15" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb25-16"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">period =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Day"</span>, <span class="st">"Day"</span>, <span class="st">"Night"</span>, <span class="st">"Night"</span>), <span class="dv">8</span>)</span>
<span id="cb25-17"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-18"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-19"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Convert Chicago temperatures to Celsius</span></span>
<span id="cb25-20"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-20" aria-hidden="true" tabindex="-1"></a>temperature_data <span class="ot">&lt;-</span> temperature_data <span class="sc">%&gt;%</span></span>
<span id="cb25-21"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb25-22"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">temperature =</span> <span class="fu">ifelse</span>(city <span class="sc">==</span> <span class="st">"Chicago"</span>, (temperature <span class="sc">-</span> <span class="dv">32</span>) <span class="sc">*</span> <span class="dv">5</span> <span class="sc">/</span> <span class="dv">9</span>, temperature)  <span class="co"># Convert °F to °C for Chicago</span></span>
<span id="cb25-23"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-24"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-25"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-25" aria-hidden="true" tabindex="-1"></a>temperature_data <span class="ot">&lt;-</span> temperature_data <span class="sc">%&gt;%</span></span>
<span id="cb25-26"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">floor_date</span>(date, <span class="at">unit =</span> <span class="st">"month"</span>))</span>
<span id="cb25-27"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-28"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-28" aria-hidden="true" tabindex="-1"></a>summary_data <span class="ot">&lt;-</span> temperature_data <span class="sc">%&gt;%</span></span>
<span id="cb25-29"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(city, month, period) <span class="sc">%&gt;%</span></span>
<span id="cb25-30"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">average_temperature =</span> <span class="fu">mean</span>(temperature), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb25-31"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-32"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-32" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(summary_data, <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> average_temperature, <span class="at">fill =</span> period)) <span class="sc">+</span></span>
<span id="cb25-33"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb25-34"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>city, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span>  <span class="co"># Separate plots for each city</span></span>
<span id="cb25-35"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb25-36"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Monthly Daytime vs. Nighttime Temperatures: Chicago vs. Berlin (°C)"</span>,</span>
<span id="cb25-37"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb25-38"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Temperature (°C)"</span>,</span>
<span id="cb25-39"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Period"</span></span>
<span id="cb25-40"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-40" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb25-41"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Day"</span> <span class="ot">=</span> <span class="st">"orange"</span>, <span class="st">"Night"</span> <span class="ot">=</span> <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb25-42"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%b %Y"</span>, <span class="at">date_breaks =</span> <span class="st">"1 month"</span>) <span class="sc">+</span></span>
<span id="cb25-43"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb25-44"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb25-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Urban Heat Island_files/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>############################</p>
<p>We can use the function as below to find out timeline and validate it.</p>
<p>############################</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb26-1" aria-hidden="true" tabindex="-1"></a>fetch_weather_data_owm <span class="ot">&lt;-</span> <span class="cf">function</span>(lat, lon, start_date, end_date, api_key) {</span>
<span id="cb26-2"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb26-2" aria-hidden="true" tabindex="-1"></a>  base_url <span class="ot">&lt;-</span> <span class="st">"https://api.openweathermap.org/data/2.5/onecall/timemachine"</span></span>
<span id="cb26-3"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb26-3" aria-hidden="true" tabindex="-1"></a>  response <span class="ot">&lt;-</span> <span class="fu">GET</span>(base_url, <span class="at">query =</span> <span class="fu">list</span>(</span>
<span id="cb26-4"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">lat =</span> lat,</span>
<span id="cb26-5"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">lon =</span> lon,</span>
<span id="cb26-6"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">dt =</span> <span class="fu">as.numeric</span>(<span class="fu">as.POSIXct</span>(start_date)),</span>
<span id="cb26-7"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">appid =</span> api_key,</span>
<span id="cb26-8"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">units =</span> <span class="st">"metric"</span>  <span class="co"># Celsius</span></span>
<span id="cb26-9"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb26-9" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb26-10"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb26-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-11"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (response<span class="sc">$</span>status_code <span class="sc">!=</span> <span class="dv">200</span>) {</span>
<span id="cb26-12"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb26-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Failed to fetch data from OpenWeatherMap."</span>)</span>
<span id="cb26-13"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb26-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb26-14"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb26-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-15"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb26-15" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="fu">content</span>(response, <span class="st">"text"</span>, <span class="at">encoding =</span> <span class="st">"UTF-8"</span>))</span>
<span id="cb26-16"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb26-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(data)</span>
<span id="cb26-17"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb26-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-18"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb26-18" aria-hidden="true" tabindex="-1"></a>response <span class="ot">&lt;-</span> <span class="fu">GET</span>(<span class="st">"https://archive-api.open-meteo.com/v1/archive"</span>,</span>
<span id="cb26-19"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb26-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">query =</span> <span class="fu">list</span>(<span class="at">latitude =</span> <span class="fl">41.8781</span>,</span>
<span id="cb26-20"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb26-20" aria-hidden="true" tabindex="-1"></a>                             <span class="at">longitude =</span> <span class="sc">-</span><span class="fl">87.6298</span>,</span>
<span id="cb26-21"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb26-21" aria-hidden="true" tabindex="-1"></a>                             <span class="at">start_date =</span> <span class="st">"2024-01-01"</span>,</span>
<span id="cb26-22"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb26-22" aria-hidden="true" tabindex="-1"></a>                             <span class="at">end_date =</span> <span class="st">"2024-01-31"</span>,</span>
<span id="cb26-23"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb26-23" aria-hidden="true" tabindex="-1"></a>                             <span class="at">hourly =</span> <span class="st">"temperature_2m"</span>,</span>
<span id="cb26-24"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb26-24" aria-hidden="true" tabindex="-1"></a>                             <span class="at">daily =</span> <span class="st">"sunrise,sunset"</span>,</span>
<span id="cb26-25"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb26-25" aria-hidden="true" tabindex="-1"></a>                             <span class="at">timezone =</span> <span class="st">"auto"</span>))</span>
<span id="cb26-26"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb26-26" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">content</span>(response, <span class="st">"text"</span>, <span class="at">encoding =</span> <span class="st">"UTF-8"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "{\"latitude\":41.862915,\"longitude\":-87.64877,\"generationtime_ms\":0.0749826431274414,\"utc_offset_seconds\":-21600,\"timezone\":\"America/Chicago\",\"timezone_abbreviation\":\"CST\",\"elevation\":241.0,\"hourly_units\":{\"time\":\"iso8601\",\"temperature_2m\":\"°C\"},\"hourly\":{\"time\":[\"2024-01-01T00:00\",\"2024-01-01T01:00\",\"2024-01-01T02:00\",\"2024-01-01T03:00\",\"2024-01-01T04:00\",\"2024-01-01T05:00\",\"2024-01-01T06:00\",\"2024-01-01T07:00\",\"2024-01-01T08:00\",\"2024-01-01T09:00\",\"2024-01-01T10:00\",\"2024-01-01T11:00\",\"2024-01-01T12:00\",\"2024-01-01T13:00\",\"2024-01-01T14:00\",\"2024-01-01T15:00\",\"2024-01-01T16:00\",\"2024-01-01T17:00\",\"2024-01-01T18:00\",\"2024-01-01T19:00\",\"2024-01-01T20:00\",\"2024-01-01T21:00\",\"2024-01-01T22:00\",\"2024-01-01T23:00\",\"2024-01-02T00:00\",\"2024-01-02T01:00\",\"2024-01-02T02:00\",\"2024-01-02T03:00\",\"2024-01-02T04:00\",\"2024-01-02T05:00\",\"2024-01-02T06:00\",\"2024-01-02T07:00\",\"2024-01-02T08:00\",\"2024-01-02T09:00\",\"2024-01-02T10:00\",\"2024-01-02T11:00\",\"2024-01-02T12:00\",\"2024-01-02T13:00\",\"2024-01-02T14:00\",\"2024-01-02T15:00\",\"2024-01-02T16:00\",\"2024-01-02T17:00\",\"2024-01-02T18:00\",\"2024-01-02T19:00\",\"2024-01-02T20:00\",\"2024-01-02T21:00\",\"2024-01-02T22:00\",\"2024-01-02T23:00\",\"2024-01-03T00:00\",\"2024-01-03T01:00\",\"2024-01-03T02:00\",\"2024-01-03T03:00\",\"2024-01-03T04:00\",\"2024-01-03T05:00\",\"2024-01-03T06:00\",\"2024-01-03T07:00\",\"2024-01-03T08:00\",\"2024-01-03T09:00\",\"2024-01-03T10:00\",\"2024-01-03T11:00\",\"2024-01-03T12:00\",\"2024-01-03T13:00\",\"2024-01-03T14:00\",\"2024-01-03T15:00\",\"2024-01-03T16:00\",\"2024-01-03T17:00\",\"2024-01-03T18:00\",\"2024-01-03T19:00\",\"2024-01-03T20:00\",\"2024-01-03T21:00\",\"2024-01-03T22:00\",\"2024-01-03T23:00\",\"2024-01-04T00:00\",\"2024-01-04T01:00\",\"2024-01-04T02:00\",\"2024-01-04T03:00\",\"2024-01-04T04:00\",\"2024-01-04T05:00\",\"2024-01-04T06:00\",\"2024-01-04T07:00\",\"2024-01-04T08:00\",\"2024-01-04T09:00\",\"2024-01-04T10:00\",\"2024-01-04T11:00\",\"2024-01-04T12:00\",\"2024-01-04T13:00\",\"2024-01-04T14:00\",\"2024-01-04T15:00\",\"2024-01-04T16:00\",\"2024-01-04T17:00\",\"2024-01-04T18:00\",\"2024-01-04T19:00\",\"2024-01-04T20:00\",\"2024-01-04T21:00\",\"2024-01-04T22:00\",\"2024-01-04T23:00\",\"2024-01-05T00:00\",\"2024-01-05T01:00\",\"2024-01-05T02:00\",\"2024-01-05T03:00\",\"2024-01-05T04:00\",\"2024-01-05T05:00\",\"2024-01-05T06:00\",\"2024-01-05T07:00\",\"2024-01-05T08:00\",\"2024-01-05T09:00\",\"2024-01-05T10:00\",\"2024-01-05T11:00\",\"2024-01-05T12:00\",\"2024-01-05T13:00\",\"2024-01-05T14:00\",\"2024-01-05T15:00\",\"2024-01-05T16:00\",\"2024-01-05T17:00\",\"2024-01-05T18:00\",\"2024-01-05T19:00\",\"2024-01-05T20:00\",\"2024-01-05T21:00\",\"2024-01-05T22:00\",\"2024-01-05T23:00\",\"2024-01-06T00:00\",\"2024-01-06T01:00\",\"2024-01-06T02:00\",\"2024-01-06T03:00\",\"2024-01-06T04:00\",\"2024-01-06T05:00\",\"2024-01-06T06:00\",\"2024-01-06T07:00\",\"2024-01-06T08:00\",\"2024-01-06T09:00\",\"2024-01-06T10:00\",\"2024-01-06T11:00\",\"2024-01-06T12:00\",\"2024-01-06T13:00\",\"2024-01-06T14:00\",\"2024-01-06T15:00\",\"2024-01-06T16:00\",\"2024-01-06T17:00\",\"2024-01-06T18:00\",\"2024-01-06T19:00\",\"2024-01-06T20:00\",\"2024-01-06T21:00\",\"2024-01-06T22:00\",\"2024-01-06T23:00\",\"2024-01-07T00:00\",\"2024-01-07T01:00\",\"2024-01-07T02:00\",\"2024-01-07T03:00\",\"2024-01-07T04:00\",\"2024-01-07T05:00\",\"2024-01-07T06:00\",\"2024-01-07T07:00\",\"2024-01-07T08:00\",\"2024-01-07T09:00\",\"2024-01-07T10:00\",\"2024-01-07T11:00\",\"2024-01-07T12:00\",\"2024-01-07T13:00\",\"2024-01-07T14:00\",\"2024-01-07T15:00\",\"2024-01-07T16:00\",\"2024-01-07T17:00\",\"2024-01-07T18:00\",\"2024-01-07T19:00\",\"2024-01-07T20:00\",\"2024-01-07T21:00\",\"2024-01-07T22:00\",\"2024-01-07T23:00\",\"2024-01-08T00:00\",\"2024-01-08T01:00\",\"2024-01-08T02:00\",\"2024-01-08T03:00\",\"2024-01-08T04:00\",\"2024-01-08T05:00\",\"2024-01-08T06:00\",\"2024-01-08T07:00\",\"2024-01-08T08:00\",\"2024-01-08T09:00\",\"2024-01-08T10:00\",\"2024-01-08T11:00\",\"2024-01-08T12:00\",\"2024-01-08T13:00\",\"2024-01-08T14:00\",\"2024-01-08T15:00\",\"2024-01-08T16:00\",\"2024-01-08T17:00\",\"2024-01-08T18:00\",\"2024-01-08T19:00\",\"2024-01-08T20:00\",\"2024-01-08T21:00\",\"2024-01-08T22:00\",\"2024-01-08T23:00\",\"2024-01-09T00:00\",\"2024-01-09T01:00\",\"2024-01-09T02:00\",\"2024-01-09T03:00\",\"2024-01-09T04:00\",\"2024-01-09T05:00\",\"2024-01-09T06:00\",\"2024-01-09T07:00\",\"2024-01-09T08:00\",\"2024-01-09T09:00\",\"2024-01-09T10:00\",\"2024-01-09T11:00\",\"2024-01-09T12:00\",\"2024-01-09T13:00\",\"2024-01-09T14:00\",\"2024-01-09T15:00\",\"2024-01-09T16:00\",\"2024-01-09T17:00\",\"2024-01-09T18:00\",\"2024-01-09T19:00\",\"2024-01-09T20:00\",\"2024-01-09T21:00\",\"2024-01-09T22:00\",\"2024-01-09T23:00\",\"2024-01-10T00:00\",\"2024-01-10T01:00\",\"2024-01-10T02:00\",\"2024-01-10T03:00\",\"2024-01-10T04:00\",\"2024-01-10T05:00\",\"2024-01-10T06:00\",\"2024-01-10T07:00\",\"2024-01-10T08:00\",\"2024-01-10T09:00\",\"2024-01-10T10:00\",\"2024-01-10T11:00\",\"2024-01-10T12:00\",\"2024-01-10T13:00\",\"2024-01-10T14:00\",\"2024-01-10T15:00\",\"2024-01-10T16:00\",\"2024-01-10T17:00\",\"2024-01-10T18:00\",\"2024-01-10T19:00\",\"2024-01-10T20:00\",\"2024-01-10T21:00\",\"2024-01-10T22:00\",\"2024-01-10T23:00\",\"2024-01-11T00:00\",\"2024-01-11T01:00\",\"2024-01-11T02:00\",\"2024-01-11T03:00\",\"2024-01-11T04:00\",\"2024-01-11T05:00\",\"2024-01-11T06:00\",\"2024-01-11T07:00\",\"2024-01-11T08:00\",\"2024-01-11T09:00\",\"2024-01-11T10:00\",\"2024-01-11T11:00\",\"2024-01-11T12:00\",\"2024-01-11T13:00\",\"2024-01-11T14:00\",\"2024-01-11T15:00\",\"2024-01-11T16:00\",\"2024-01-11T17:00\",\"2024-01-11T18:00\",\"2024-01-11T19:00\",\"2024-01-11T20:00\",\"2024-01-11T21:00\",\"2024-01-11T22:00\",\"2024-01-11T23:00\",\"2024-01-12T00:00\",\"2024-01-12T01:00\",\"2024-01-12T02:00\",\"2024-01-12T03:00\",\"2024-01-12T04:00\",\"2024-01-12T05:00\",\"2024-01-12T06:00\",\"2024-01-12T07:00\",\"2024-01-12T08:00\",\"2024-01-12T09:00\",\"2024-01-12T10:00\",\"2024-01-12T11:00\",\"2024-01-12T12:00\",\"2024-01-12T13:00\",\"2024-01-12T14:00\",\"2024-01-12T15:00\",\"2024-01-12T16:00\",\"2024-01-12T17:00\",\"2024-01-12T18:00\",\"2024-01-12T19:00\",\"2024-01-12T20:00\",\"2024-01-12T21:00\",\"2024-01-12T22:00\",\"2024-01-12T23:00\",\"2024-01-13T00:00\",\"2024-01-13T01:00\",\"2024-01-13T02:00\",\"2024-01-13T03:00\",\"2024-01-13T04:00\",\"2024-01-13T05:00\",\"2024-01-13T06:00\",\"2024-01-13T07:00\",\"2024-01-13T08:00\",\"2024-01-13T09:00\",\"2024-01-13T10:00\",\"2024-01-13T11:00\",\"2024-01-13T12:00\",\"2024-01-13T13:00\",\"2024-01-13T14:00\",\"2024-01-13T15:00\",\"2024-01-13T16:00\",\"2024-01-13T17:00\",\"2024-01-13T18:00\",\"2024-01-13T19:00\",\"2024-01-13T20:00\",\"2024-01-13T21:00\",\"2024-01-13T22:00\",\"2024-01-13T23:00\",\"2024-01-14T00:00\",\"2024-01-14T01:00\",\"2024-01-14T02:00\",\"2024-01-14T03:00\",\"2024-01-14T04:00\",\"2024-01-14T05:00\",\"2024-01-14T06:00\",\"2024-01-14T07:00\",\"2024-01-14T08:00\",\"2024-01-14T09:00\",\"2024-01-14T10:00\",\"2024-01-14T11:00\",\"2024-01-14T12:00\",\"2024-01-14T13:00\",\"2024-01-14T14:00\",\"2024-01-14T15:00\",\"2024-01-14T16:00\",\"2024-01-14T17:00\",\"2024-01-14T18:00\",\"2024-01-14T19:00\",\"2024-01-14T20:00\",\"2024-01-14T21:00\",\"2024-01-14T22:00\",\"2024-01-14T23:00\",\"2024-01-15T00:00\",\"2024-01-15T01:00\",\"2024-01-15T02:00\",\"2024-01-15T03:00\",\"2024-01-15T04:00\",\"2024-01-15T05:00\",\"2024-01-15T06:00\",\"2024-01-15T07:00\",\"2024-01-15T08:00\",\"2024-01-15T09:00\",\"2024-01-15T10:00\",\"2024-01-15T11:00\",\"2024-01-15T12:00\",\"2024-01-15T13:00\",\"2024-01-15T14:00\",\"2024-01-15T15:00\",\"2024-01-15T16:00\",\"2024-01-15T17:00\",\"2024-01-15T18:00\",\"2024-01-15T19:00\",\"2024-01-15T20:00\",\"2024-01-15T21:00\",\"2024-01-15T22:00\",\"2024-01-15T23:00\",\"2024-01-16T00:00\",\"2024-01-16T01:00\",\"2024-01-16T02:00\",\"2024-01-16T03:00\",\"2024-01-16T04:00\",\"2024-01-16T05:00\",\"2024-01-16T06:00\",\"2024-01-16T07:00\",\"2024-01-16T08:00\",\"2024-01-16T09:00\",\"2024-01-16T10:00\",\"2024-01-16T11:00\",\"2024-01-16T12:00\",\"2024-01-16T13:00\",\"2024-01-16T14:00\",\"2024-01-16T15:00\",\"2024-01-16T16:00\",\"2024-01-16T17:00\",\"2024-01-16T18:00\",\"2024-01-16T19:00\",\"2024-01-16T20:00\",\"2024-01-16T21:00\",\"2024-01-16T22:00\",\"2024-01-16T23:00\",\"2024-01-17T00:00\",\"2024-01-17T01:00\",\"2024-01-17T02:00\",\"2024-01-17T03:00\",\"2024-01-17T04:00\",\"2024-01-17T05:00\",\"2024-01-17T06:00\",\"2024-01-17T07:00\",\"2024-01-17T08:00\",\"2024-01-17T09:00\",\"2024-01-17T10:00\",\"2024-01-17T11:00\",\"2024-01-17T12:00\",\"2024-01-17T13:00\",\"2024-01-17T14:00\",\"2024-01-17T15:00\",\"2024-01-17T16:00\",\"2024-01-17T17:00\",\"2024-01-17T18:00\",\"2024-01-17T19:00\",\"2024-01-17T20:00\",\"2024-01-17T21:00\",\"2024-01-17T22:00\",\"2024-01-17T23:00\",\"2024-01-18T00:00\",\"2024-01-18T01:00\",\"2024-01-18T02:00\",\"2024-01-18T03:00\",\"2024-01-18T04:00\",\"2024-01-18T05:00\",\"2024-01-18T06:00\",\"2024-01-18T07:00\",\"2024-01-18T08:00\",\"2024-01-18T09:00\",\"2024-01-18T10:00\",\"2024-01-18T11:00\",\"2024-01-18T12:00\",\"2024-01-18T13:00\",\"2024-01-18T14:00\",\"2024-01-18T15:00\",\"2024-01-18T16:00\",\"2024-01-18T17:00\",\"2024-01-18T18:00\",\"2024-01-18T19:00\",\"2024-01-18T20:00\",\"2024-01-18T21:00\",\"2024-01-18T22:00\",\"2024-01-18T23:00\",\"2024-01-19T00:00\",\"2024-01-19T01:00\",\"2024-01-19T02:00\",\"2024-01-19T03:00\",\"2024-01-19T04:00\",\"2024-01-19T05:00\",\"2024-01-19T06:00\",\"2024-01-19T07:00\",\"2024-01-19T08:00\",\"2024-01-19T09:00\",\"2024-01-19T10:00\",\"2024-01-19T11:00\",\"2024-01-19T12:00\",\"2024-01-19T13:00\",\"2024-01-19T14:00\",\"2024-01-19T15:00\",\"2024-01-19T16:00\",\"2024-01-19T17:00\",\"2024-01-19T18:00\",\"2024-01-19T19:00\",\"2024-01-19T20:00\",\"2024-01-19T21:00\",\"2024-01-19T22:00\",\"2024-01-19T23:00\",\"2024-01-20T00:00\",\"2024-01-20T01:00\",\"2024-01-20T02:00\",\"2024-01-20T03:00\",\"2024-01-20T04:00\",\"2024-01-20T05:00\",\"2024-01-20T06:00\",\"2024-01-20T07:00\",\"2024-01-20T08:00\",\"2024-01-20T09:00\",\"2024-01-20T10:00\",\"2024-01-20T11:00\",\"2024-01-20T12:00\",\"2024-01-20T13:00\",\"2024-01-20T14:00\",\"2024-01-20T15:00\",\"2024-01-20T16:00\",\"2024-01-20T17:00\",\"2024-01-20T18:00\",\"2024-01-20T19:00\",\"2024-01-20T20:00\",\"2024-01-20T21:00\",\"2024-01-20T22:00\",\"2024-01-20T23:00\",\"2024-01-21T00:00\",\"2024-01-21T01:00\",\"2024-01-21T02:00\",\"2024-01-21T03:00\",\"2024-01-21T04:00\",\"2024-01-21T05:00\",\"2024-01-21T06:00\",\"2024-01-21T07:00\",\"2024-01-21T08:00\",\"2024-01-21T09:00\",\"2024-01-21T10:00\",\"2024-01-21T11:00\",\"2024-01-21T12:00\",\"2024-01-21T13:00\",\"2024-01-21T14:00\",\"2024-01-21T15:00\",\"2024-01-21T16:00\",\"2024-01-21T17:00\",\"2024-01-21T18:00\",\"2024-01-21T19:00\",\"2024-01-21T20:00\",\"2024-01-21T21:00\",\"2024-01-21T22:00\",\"2024-01-21T23:00\",\"2024-01-22T00:00\",\"2024-01-22T01:00\",\"2024-01-22T02:00\",\"2024-01-22T03:00\",\"2024-01-22T04:00\",\"2024-01-22T05:00\",\"2024-01-22T06:00\",\"2024-01-22T07:00\",\"2024-01-22T08:00\",\"2024-01-22T09:00\",\"2024-01-22T10:00\",\"2024-01-22T11:00\",\"2024-01-22T12:00\",\"2024-01-22T13:00\",\"2024-01-22T14:00\",\"2024-01-22T15:00\",\"2024-01-22T16:00\",\"2024-01-22T17:00\",\"2024-01-22T18:00\",\"2024-01-22T19:00\",\"2024-01-22T20:00\",\"2024-01-22T21:00\",\"2024-01-22T22:00\",\"2024-01-22T23:00\",\"2024-01-23T00:00\",\"2024-01-23T01:00\",\"2024-01-23T02:00\",\"2024-01-23T03:00\",\"2024-01-23T04:00\",\"2024-01-23T05:00\",\"2024-01-23T06:00\",\"2024-01-23T07:00\",\"2024-01-23T08:00\",\"2024-01-23T09:00\",\"2024-01-23T10:00\",\"2024-01-23T11:00\",\"2024-01-23T12:00\",\"2024-01-23T13:00\",\"2024-01-23T14:00\",\"2024-01-23T15:00\",\"2024-01-23T16:00\",\"2024-01-23T17:00\",\"2024-01-23T18:00\",\"2024-01-23T19:00\",\"2024-01-23T20:00\",\"2024-01-23T21:00\",\"2024-01-23T22:00\",\"2024-01-23T23:00\",\"2024-01-24T00:00\",\"2024-01-24T01:00\",\"2024-01-24T02:00\",\"2024-01-24T03:00\",\"2024-01-24T04:00\",\"2024-01-24T05:00\",\"2024-01-24T06:00\",\"2024-01-24T07:00\",\"2024-01-24T08:00\",\"2024-01-24T09:00\",\"2024-01-24T10:00\",\"2024-01-24T11:00\",\"2024-01-24T12:00\",\"2024-01-24T13:00\",\"2024-01-24T14:00\",\"2024-01-24T15:00\",\"2024-01-24T16:00\",\"2024-01-24T17:00\",\"2024-01-24T18:00\",\"2024-01-24T19:00\",\"2024-01-24T20:00\",\"2024-01-24T21:00\",\"2024-01-24T22:00\",\"2024-01-24T23:00\",\"2024-01-25T00:00\",\"2024-01-25T01:00\",\"2024-01-25T02:00\",\"2024-01-25T03:00\",\"2024-01-25T04:00\",\"2024-01-25T05:00\",\"2024-01-25T06:00\",\"2024-01-25T07:00\",\"2024-01-25T08:00\",\"2024-01-25T09:00\",\"2024-01-25T10:00\",\"2024-01-25T11:00\",\"2024-01-25T12:00\",\"2024-01-25T13:00\",\"2024-01-25T14:00\",\"2024-01-25T15:00\",\"2024-01-25T16:00\",\"2024-01-25T17:00\",\"2024-01-25T18:00\",\"2024-01-25T19:00\",\"2024-01-25T20:00\",\"2024-01-25T21:00\",\"2024-01-25T22:00\",\"2024-01-25T23:00\",\"2024-01-26T00:00\",\"2024-01-26T01:00\",\"2024-01-26T02:00\",\"2024-01-26T03:00\",\"2024-01-26T04:00\",\"2024-01-26T05:00\",\"2024-01-26T06:00\",\"2024-01-26T07:00\",\"2024-01-26T08:00\",\"2024-01-26T09:00\",\"2024-01-26T10:00\",\"2024-01-26T11:00\",\"2024-01-26T12:00\",\"2024-01-26T13:00\",\"2024-01-26T14:00\",\"2024-01-26T15:00\",\"2024-01-26T16:00\",\"2024-01-26T17:00\",\"2024-01-26T18:00\",\"2024-01-26T19:00\",\"2024-01-26T20:00\",\"2024-01-26T21:00\",\"2024-01-26T22:00\",\"2024-01-26T23:00\",\"2024-01-27T00:00\",\"2024-01-27T01:00\",\"2024-01-27T02:00\",\"2024-01-27T03:00\",\"2024-01-27T04:00\",\"2024-01-27T05:00\",\"2024-01-27T06:00\",\"2024-01-27T07:00\",\"2024-01-27T08:00\",\"2024-01-27T09:00\",\"2024-01-27T10:00\",\"2024-01-27T11:00\",\"2024-01-27T12:00\",\"2024-01-27T13:00\",\"2024-01-27T14:00\",\"2024-01-27T15:00\",\"2024-01-27T16:00\",\"2024-01-27T17:00\",\"2024-01-27T18:00\",\"2024-01-27T19:00\",\"2024-01-27T20:00\",\"2024-01-27T21:00\",\"2024-01-27T22:00\",\"2024-01-27T23:00\",\"2024-01-28T00:00\",\"2024-01-28T01:00\",\"2024-01-28T02:00\",\"2024-01-28T03:00\",\"2024-01-28T04:00\",\"2024-01-28T05:00\",\"2024-01-28T06:00\",\"2024-01-28T07:00\",\"2024-01-28T08:00\",\"2024-01-28T09:00\",\"2024-01-28T10:00\",\"2024-01-28T11:00\",\"2024-01-28T12:00\",\"2024-01-28T13:00\",\"2024-01-28T14:00\",\"2024-01-28T15:00\",\"2024-01-28T16:00\",\"2024-01-28T17:00\",\"2024-01-28T18:00\",\"2024-01-28T19:00\",\"2024-01-28T20:00\",\"2024-01-28T21:00\",\"2024-01-28T22:00\",\"2024-01-28T23:00\",\"2024-01-29T00:00\",\"2024-01-29T01:00\",\"2024-01-29T02:00\",\"2024-01-29T03:00\",\"2024-01-29T04:00\",\"2024-01-29T05:00\",\"2024-01-29T06:00\",\"2024-01-29T07:00\",\"2024-01-29T08:00\",\"2024-01-29T09:00\",\"2024-01-29T10:00\",\"2024-01-29T11:00\",\"2024-01-29T12:00\",\"2024-01-29T13:00\",\"2024-01-29T14:00\",\"2024-01-29T15:00\",\"2024-01-29T16:00\",\"2024-01-29T17:00\",\"2024-01-29T18:00\",\"2024-01-29T19:00\",\"2024-01-29T20:00\",\"2024-01-29T21:00\",\"2024-01-29T22:00\",\"2024-01-29T23:00\",\"2024-01-30T00:00\",\"2024-01-30T01:00\",\"2024-01-30T02:00\",\"2024-01-30T03:00\",\"2024-01-30T04:00\",\"2024-01-30T05:00\",\"2024-01-30T06:00\",\"2024-01-30T07:00\",\"2024-01-30T08:00\",\"2024-01-30T09:00\",\"2024-01-30T10:00\",\"2024-01-30T11:00\",\"2024-01-30T12:00\",\"2024-01-30T13:00\",\"2024-01-30T14:00\",\"2024-01-30T15:00\",\"2024-01-30T16:00\",\"2024-01-30T17:00\",\"2024-01-30T18:00\",\"2024-01-30T19:00\",\"2024-01-30T20:00\",\"2024-01-30T21:00\",\"2024-01-30T22:00\",\"2024-01-30T23:00\",\"2024-01-31T00:00\",\"2024-01-31T01:00\",\"2024-01-31T02:00\",\"2024-01-31T03:00\",\"2024-01-31T04:00\",\"2024-01-31T05:00\",\"2024-01-31T06:00\",\"2024-01-31T07:00\",\"2024-01-31T08:00\",\"2024-01-31T09:00\",\"2024-01-31T10:00\",\"2024-01-31T11:00\",\"2024-01-31T12:00\",\"2024-01-31T13:00\",\"2024-01-31T14:00\",\"2024-01-31T15:00\",\"2024-01-31T16:00\",\"2024-01-31T17:00\",\"2024-01-31T18:00\",\"2024-01-31T19:00\",\"2024-01-31T20:00\",\"2024-01-31T21:00\",\"2024-01-31T22:00\",\"2024-01-31T23:00\"],\"temperature_2m\":[-0.0,0.1,0.4,0.2,-0.3,-1.1,-1.5,-1.4,-1.9,-1.7,-0.9,-0.2,0.3,1.0,1.0,0.7,-0.3,-1.7,-2.6,-2.1,-2.2,-2.7,-3.0,-3.5,-4.0,-4.5,-4.8,-5.0,-5.0,-4.9,-4.9,-4.9,-4.3,-2.9,-1.3,0.4,1.4,1.9,2.1,2.1,1.7,1.0,0.4,-1.0,-2.0,-2.4,-2.1,-1.8,-1.4,-1.4,-1.4,-1.3,-1.3,-1.3,-1.2,-1.4,-1.1,-0.4,0.1,1.1,1.5,1.5,1.7,1.7,1.3,0.9,0.7,0.0,-0.3,-0.5,-1.3,-1.5,-1.8,-1.6,-1.1,-1.6,-2.8,-3.0,-2.6,-2.2,-2.4,-1.7,-0.8,-0.3,0.1,0.3,0.5,0.6,0.0,-2.0,-2.8,-3.6,-4.3,-4.9,-5.0,-4.7,-4.8,-5.7,-5.8,-5.8,-5.4,-5.4,-5.2,-4.3,-3.8,-2.4,-0.7,0.6,1.0,1.5,1.7,1.6,0.7,-0.7,-0.5,-0.1,-0.1,-0.3,-0.5,-0.8,-1.0,-1.1,-0.9,-1.0,-1.2,-1.3,-1.3,-1.0,-0.9,-0.7,-0.4,-0.4,-0.3,-0.1,0.2,0.3,0.3,-0.2,-0.1,-0.3,-0.3,-0.4,-0.5,-0.6,-0.6,-0.7,-0.8,-0.8,-1.0,-1.0,-1.4,-1.2,-1.3,-0.9,-0.3,0.3,0.8,1.0,1.1,1.0,0.7,0.5,0.5,-0.9,-2.2,-2.9,-3.1,-3.2,-3.2,-2.9,-2.6,-2.1,-2.4,-2.0,-1.7,-1.0,-0.6,-0.2,0.6,1.4,2.1,2.4,2.6,2.4,1.7,1.5,1.7,1.1,1.0,0.8,0.8,0.7,0.4,0.4,0.5,0.5,0.4,0.4,0.9,0.9,0.6,0.9,0.8,0.7,1.6,2.0,1.2,1.2,0.9,0.7,0.8,0.7,0.9,0.8,0.6,0.4,0.0,-0.3,-0.3,-0.3,-1.0,-1.4,-2.1,-0.5,-0.6,-0.4,-0.2,0.4,0.4,-0.1,-0.5,-1.0,-1.5,-1.8,-1.7,-1.6,-2.0,-1.9,-1.6,-1.4,-1.3,-1.3,-1.1,-0.8,-1.6,-1.6,-2.0,-1.0,-0.8,-0.4,-0.1,-0.0,0.1,0.4,0.6,0.4,-0.5,-2.3,-3.6,-3.8,-4.0,-3.9,-2.2,-1.5,-1.5,-1.1,-0.7,-0.4,-0.2,-0.0,0.0,0.4,0.5,0.4,0.6,1.0,1.0,1.6,2.7,2.7,2.2,2.1,2.3,0.7,0.1,0.3,0.3,0.3,0.1,-0.7,-1.4,-2.9,-3.7,-3.8,-3.7,-3.2,-3.4,-3.5,-3.7,-3.0,-3.1,-4.3,-5.1,-6.0,-8.5,-11.1,-12.3,-13.3,-14.1,-15.2,-15.9,-16.6,-17.4,-18.1,-18.8,-19.5,-20.3,-21.4,-22.2,-23.1,-23.6,-23.4,-22.8,-22.0,-21.3,-21.2,-21.1,-21.2,-22.1,-22.7,-22.6,-22.5,-22.9,-23.1,-23.4,-23.6,-24.0,-24.3,-24.6,-24.7,-24.9,-25.1,-25.2,-23.6,-23.2,-22.4,-21.2,-19.7,-18.7,-18.0,-17.7,-18.0,-18.7,-19.8,-19.8,-19.5,-19.5,-19.5,-19.6,-19.5,-19.5,-19.3,-19.3,-19.4,-20.2,-21.3,-22.3,-21.8,-22.0,-21.3,-20.0,-18.8,-17.9,-17.4,-17.1,-17.0,-17.5,-18.1,-18.4,-17.6,-17.6,-17.5,-17.5,-17.4,-17.4,-17.4,-17.4,-17.5,-17.6,-17.5,-16.8,-16.0,-15.1,-13.6,-11.5,-9.7,-8.7,-8.2,-8.0,-8.1,-8.6,-9.7,-9.7,-9.1,-8.6,-8.3,-8.1,-7.9,-7.8,-7.7,-8.0,-8.2,-8.6,-8.6,-9.3,-8.3,-8.0,-7.3,-6.4,-5.4,-4.9,-4.5,-4.5,-5.2,-5.7,-6.0,-6.2,-6.6,-7.2,-8.3,-9.6,-10.6,-11.2,-10.8,-10.9,-11.0,-10.8,-11.4,-11.9,-12.0,-12.0,-12.2,-12.5,-12.3,-11.6,-10.9,-10.8,-11.1,-12.0,-12.6,-12.9,-13.0,-13.3,-13.6,-14.1,-14.5,-14.8,-14.8,-15.3,-14.8,-14.6,-14.8,-15.1,-14.3,-14.0,-12.6,-11.3,-9.9,-8.6,-7.5,-7.2,-7.5,-8.6,-10.4,-11.6,-12.5,-13.3,-14.2,-14.8,-15.3,-15.8,-16.3,-16.8,-17.3,-17.8,-18.2,-18.5,-18.3,-17.8,-15.8,-12.5,-9.4,-7.7,-6.5,-5.7,-5.4,-5.7,-6.9,-7.0,-8.2,-8.1,-8.1,-8.1,-8.0,-7.3,-6.4,-5.8,-5.4,-5.1,-4.6,-4.3,-3.7,-3.4,-2.7,-1.2,-1.4,-0.9,-0.4,-0.1,0.1,0.0,-0.2,-0.4,-0.5,-0.5,-0.4,-0.4,-0.6,-0.7,-0.5,-0.7,-0.7,-0.6,-0.6,-0.6,-0.1,0.1,0.3,1.0,0.9,1.0,1.2,1.5,1.6,1.6,1.0,0.8,-1.5,-1.2,-1.2,-0.9,-0.9,-0.9,-0.9,-0.9,-0.9,-0.8,-0.5,-0.3,0.3,0.6,1.0,1.4,1.5,1.5,1.8,2.2,1.7,1.6,1.5,1.4,1.5,1.4,1.3,1.1,0.9,0.6,0.9,0.7,0.8,0.6,0.7,0.9,0.7,1.0,2.2,3.1,3.7,3.8,3.4,3.0,2.4,2.0,2.1,2.1,2.3,2.4,2.4,2.4,2.2,2.1,2.0,1.9,1.8,1.9,2.0,1.8,1.7,1.8,2.2,3.3,3.6,3.4,3.0,2.6,2.6,2.1,1.7,1.7,1.9,1.6,1.4,1.3,1.2,1.0,1.0,1.0,0.5,-0.3,0.3,0.6,0.8,0.9,1.6,2.2,2.6,2.8,2.7,2.3,2.0,1.7,1.6,1.6,1.5,1.5,1.4,1.3,1.3,1.4,1.5,1.6,1.5,1.6,1.6,1.5,1.4,1.5,1.7,2.2,2.2,2.4,2.5,2.6,2.2,1.7,1.1,0.7,0.4,-0.0,0.0,-0.3,-0.4,-0.3,-0.6,-1.5,-2.3,-2.4,-2.9,-3.3,-3.4,-2.9,-2.0,-0.5,1.5,3.4,4.8,5.6,5.9,5.5,3.9,2.9,0.0,-0.1,-0.2,-0.0,0.3,0.8,0.9,0.7,0.8,0.4,-0.2,-0.3,0.4,0.9,1.6,2.4,2.7,4.1,4.3,3.3,3.1,2.8,2.1,1.8,1.6,1.5,1.3,1.2,1.2,0.9,0.5,-0.2,-1.2,-1.6,-2.2,-2.7,-1.6,-1.2,0.6,3.0,4.5,5.4,6.2,6.7,6.8,6.3,4.6,3.5,0.5,0.6,0.6,0.5,0.5]},\"daily_units\":{\"time\":\"iso8601\",\"sunrise\":\"iso8601\",\"sunset\":\"iso8601\"},\"daily\":{\"time\":[\"2024-01-01\",\"2024-01-02\",\"2024-01-03\",\"2024-01-04\",\"2024-01-05\",\"2024-01-06\",\"2024-01-07\",\"2024-01-08\",\"2024-01-09\",\"2024-01-10\",\"2024-01-11\",\"2024-01-12\",\"2024-01-13\",\"2024-01-14\",\"2024-01-15\",\"2024-01-16\",\"2024-01-17\",\"2024-01-18\",\"2024-01-19\",\"2024-01-20\",\"2024-01-21\",\"2024-01-22\",\"2024-01-23\",\"2024-01-24\",\"2024-01-25\",\"2024-01-26\",\"2024-01-27\",\"2024-01-28\",\"2024-01-29\",\"2024-01-30\",\"2024-01-31\"],\"sunrise\":[\"2024-01-01T07:18\",\"2024-01-02T07:18\",\"2024-01-03T07:18\",\"2024-01-04T07:18\",\"2024-01-05T07:18\",\"2024-01-06T07:18\",\"2024-01-07T07:18\",\"2024-01-08T07:17\",\"2024-01-09T07:17\",\"2024-01-10T07:17\",\"2024-01-11T07:17\",\"2024-01-12T07:16\",\"2024-01-13T07:16\",\"2024-01-14T07:16\",\"2024-01-15T07:15\",\"2024-01-16T07:15\",\"2024-01-17T07:14\",\"2024-01-18T07:14\",\"2024-01-19T07:13\",\"2024-01-20T07:13\",\"2024-01-21T07:12\",\"2024-01-22T07:11\",\"2024-01-23T07:11\",\"2024-01-24T07:10\",\"2024-01-25T07:09\",\"2024-01-26T07:08\",\"2024-01-27T07:07\",\"2024-01-28T07:06\",\"2024-01-29T07:06\",\"2024-01-30T07:05\",\"2024-01-31T07:04\"],\"sunset\":[\"2024-01-01T16:29\",\"2024-01-02T16:30\",\"2024-01-03T16:31\",\"2024-01-04T16:32\",\"2024-01-05T16:33\",\"2024-01-06T16:34\",\"2024-01-07T16:35\",\"2024-01-08T16:36\",\"2024-01-09T16:37\",\"2024-01-10T16:38\",\"2024-01-11T16:39\",\"2024-01-12T16:40\",\"2024-01-13T16:41\",\"2024-01-14T16:42\",\"2024-01-15T16:43\",\"2024-01-16T16:45\",\"2024-01-17T16:46\",\"2024-01-18T16:47\",\"2024-01-19T16:48\",\"2024-01-20T16:49\",\"2024-01-21T16:51\",\"2024-01-22T16:52\",\"2024-01-23T16:53\",\"2024-01-24T16:54\",\"2024-01-25T16:56\",\"2024-01-26T16:57\",\"2024-01-27T16:58\",\"2024-01-28T16:59\",\"2024-01-29T17:01\",\"2024-01-30T17:02\",\"2024-01-31T17:03\"]}}"</code></pre>
</div>
</div>
<p>############################</p>
<p>From this part, we have already confirm the timeline and then we can do our assignments.</p>
<p>For user who wants to put in some data set from website or some ways that you can find out temp then just plug into this entire coding stuff, which can make sure your data will be present as below.</p>
<p>And also, there have some different methods to do it!</p>
<p>Method 1:</p>
<p>If you want to combine them together by using integration package, the first two procedure you can use that can make sure the whole data set bond together and don’t separate. Which can show the graph around different cities and different temps.</p>
<p>############################</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-1" aria-hidden="true" tabindex="-1"></a>fetch_weather_data <span class="ot">&lt;-</span> <span class="cf">function</span>(lat, lon, start_date, end_date, api_key) {</span>
<span id="cb28-2"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-2" aria-hidden="true" tabindex="-1"></a>  base_url <span class="ot">&lt;-</span> <span class="st">"https://archive-api.open-meteo.com/v1/archive"</span></span>
<span id="cb28-3"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-4"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-4" aria-hidden="true" tabindex="-1"></a>  response <span class="ot">&lt;-</span> <span class="fu">GET</span>(base_url, <span class="at">query =</span> <span class="fu">list</span>(</span>
<span id="cb28-5"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">latitude =</span> lat,</span>
<span id="cb28-6"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">longitude =</span> lon,</span>
<span id="cb28-7"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">start_date =</span> start_date,</span>
<span id="cb28-8"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">end_date =</span> end_date,</span>
<span id="cb28-9"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">hourly =</span> <span class="st">"temperature_2m"</span>,</span>
<span id="cb28-10"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">daily =</span> <span class="st">"sunrise,sunset"</span>,</span>
<span id="cb28-11"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">timezone =</span> <span class="st">"auto"</span>,</span>
<span id="cb28-12"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">api_key =</span> api_key</span>
<span id="cb28-13"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-13" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb28-14"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-15"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (response<span class="sc">$</span>status_code <span class="sc">==</span> <span class="dv">401</span>) {</span>
<span id="cb28-16"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Unauthorized access. Please check your API key."</span>)</span>
<span id="cb28-17"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb28-18"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-19"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (response<span class="sc">$</span>status_code <span class="sc">!=</span> <span class="dv">200</span>) {</span>
<span id="cb28-20"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="fu">paste</span>(<span class="st">"Failed to fetch data. HTTP Status:"</span>, response<span class="sc">$</span>status_code))</span>
<span id="cb28-21"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb28-22"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-23"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-23" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="fu">content</span>(response, <span class="st">"text"</span>, <span class="at">encoding =</span> <span class="st">"UTF-8"</span>))</span>
<span id="cb28-24"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(data)</span>
<span id="cb28-25"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-26"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-27"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Add API key</span></span>
<span id="cb28-28"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-28" aria-hidden="true" tabindex="-1"></a>api_key <span class="ot">&lt;-</span> <span class="st">"YOUR_API_KEY_HERE"</span></span>
<span id="cb28-29"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-30"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-30" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatch</span>({</span>
<span id="cb28-31"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-31" aria-hidden="true" tabindex="-1"></a>  chicago_data <span class="ot">&lt;-</span> <span class="fu">fetch_weather_data</span>(<span class="fl">41.8781</span>, <span class="sc">-</span><span class="fl">87.6298</span>, <span class="st">"2023-01-01"</span>, <span class="st">"2023-12-31"</span>, api_key)</span>
<span id="cb28-32"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Chicago data fetched successfully!"</span>)</span>
<span id="cb28-33"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-33" aria-hidden="true" tabindex="-1"></a>}, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb28-34"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Error fetching Chicago data:"</span>)</span>
<span id="cb28-35"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(e)</span>
<span id="cb28-36"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb28-36" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Chicago data fetched successfully!"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb30-2"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb30-3"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb30-4"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-5" aria-hidden="true" tabindex="-1"></a>generate_weather_data <span class="ot">&lt;-</span> <span class="cf">function</span>(city_name, lat, lon, start_date, end_date) {</span>
<span id="cb30-6"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-6" aria-hidden="true" tabindex="-1"></a>  time_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(</span>
<span id="cb30-7"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">from =</span> <span class="fu">as.POSIXct</span>(start_date),</span>
<span id="cb30-8"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">to =</span> <span class="fu">as.POSIXct</span>(end_date),</span>
<span id="cb30-9"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"hour"</span></span>
<span id="cb30-10"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-11"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-12"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define synthetic temperature patterns</span></span>
<span id="cb30-13"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-13" aria-hidden="true" tabindex="-1"></a>  temperature <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">+</span> <span class="dv">10</span> <span class="sc">*</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> (<span class="fu">yday</span>(time_seq) <span class="sc">-</span> <span class="dv">80</span>) <span class="sc">/</span> <span class="dv">365</span>) <span class="sc">+</span></span>
<span id="cb30-14"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-14" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span> <span class="sc">*</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="fu">hour</span>(time_seq) <span class="sc">/</span> <span class="dv">24</span>) <span class="sc">+</span></span>
<span id="cb30-15"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="fu">length</span>(time_seq), <span class="dv">0</span>, <span class="dv">3</span>)  <span class="co"># Add some randomness</span></span>
<span id="cb30-16"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-17"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-17" aria-hidden="true" tabindex="-1"></a>  sunrise_times <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"07:00"</span>, <span class="st">"06:30"</span>, <span class="st">"05:30"</span>, <span class="st">"05:00"</span>, <span class="st">"05:00"</span>, <span class="st">"05:30"</span>,</span>
<span id="cb30-18"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-18" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"06:00"</span>, <span class="st">"06:30"</span>, <span class="st">"07:00"</span>, <span class="st">"07:30"</span>, <span class="st">"07:00"</span>, <span class="st">"07:00"</span>),</span>
<span id="cb30-19"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-19" aria-hidden="true" tabindex="-1"></a>                       <span class="at">each =</span> <span class="dv">30</span>)</span>
<span id="cb30-20"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-20" aria-hidden="true" tabindex="-1"></a>  sunset_times <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"17:00"</span>, <span class="st">"18:00"</span>, <span class="st">"19:00"</span>, <span class="st">"20:00"</span>, <span class="st">"21:00"</span>, <span class="st">"21:30"</span>,</span>
<span id="cb30-21"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-21" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"21:00"</span>, <span class="st">"20:00"</span>, <span class="st">"19:00"</span>, <span class="st">"18:00"</span>, <span class="st">"17:00"</span>, <span class="st">"17:00"</span>),</span>
<span id="cb30-22"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-22" aria-hidden="true" tabindex="-1"></a>                      <span class="at">each =</span> <span class="dv">30</span>)</span>
<span id="cb30-23"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-24"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Repeat sunrise/sunset for all days in the range</span></span>
<span id="cb30-25"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-25" aria-hidden="true" tabindex="-1"></a>  sunrise <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(<span class="fu">paste</span>(<span class="fu">as.Date</span>(time_seq), sunrise_times[<span class="fu">month</span>(time_seq)]), <span class="at">tz =</span> <span class="st">"UTC"</span>)</span>
<span id="cb30-26"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-26" aria-hidden="true" tabindex="-1"></a>  sunset <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(<span class="fu">paste</span>(<span class="fu">as.Date</span>(time_seq), sunset_times[<span class="fu">month</span>(time_seq)]), <span class="at">tz =</span> <span class="st">"UTC"</span>)</span>
<span id="cb30-27"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-28"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-28" aria-hidden="true" tabindex="-1"></a>  period <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(time_seq <span class="sc">&gt;=</span> sunrise <span class="sc">&amp;</span> time_seq <span class="sc">&lt;=</span> sunset, <span class="st">"Day"</span>, <span class="st">"Night"</span>)</span>
<span id="cb30-29"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-30"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-30" aria-hidden="true" tabindex="-1"></a>  weather_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb30-31"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">city =</span> city_name,</span>
<span id="cb30-32"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">time =</span> time_seq,</span>
<span id="cb30-33"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">temperature =</span> temperature,</span>
<span id="cb30-34"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">period =</span> period</span>
<span id="cb30-35"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-35" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-36"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-37"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(weather_data)</span>
<span id="cb30-38"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-39"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-40"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-40" aria-hidden="true" tabindex="-1"></a>start_date <span class="ot">&lt;-</span> <span class="st">"2023-01-01"</span></span>
<span id="cb30-41"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-41" aria-hidden="true" tabindex="-1"></a>end_date <span class="ot">&lt;-</span> <span class="st">"2023-12-31"</span></span>
<span id="cb30-42"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-43"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-43" aria-hidden="true" tabindex="-1"></a>chicago_data <span class="ot">&lt;-</span> <span class="fu">generate_weather_data</span>(<span class="st">"Chicago"</span>, <span class="fl">41.8781</span>, <span class="sc">-</span><span class="fl">87.6298</span>, start_date, end_date)</span>
<span id="cb30-44"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-44" aria-hidden="true" tabindex="-1"></a>berlin_data <span class="ot">&lt;-</span> <span class="fu">generate_weather_data</span>(<span class="st">"Berlin"</span>, <span class="fl">52.5200</span>, <span class="fl">13.4050</span>, start_date, end_date)</span>
<span id="cb30-45"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-46"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-46" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(chicago_data, berlin_data)</span>
<span id="cb30-47"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-48"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-48" aria-hidden="true" tabindex="-1"></a>monthly_summary <span class="ot">&lt;-</span> combined_data <span class="sc">%&gt;%</span></span>
<span id="cb30-49"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">floor_date</span>(time, <span class="st">"month"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb30-50"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(city, month, period) <span class="sc">%&gt;%</span></span>
<span id="cb30-51"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">average_temperature =</span> <span class="fu">mean</span>(temperature, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-52"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">as.Date</span>(month))  <span class="co"># Convert to Date explicitly</span></span>
<span id="cb30-53"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-54"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-54" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(monthly_summary, <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> average_temperature, <span class="at">fill =</span> period)) <span class="sc">+</span></span>
<span id="cb30-55"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb30-56"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>city, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb30-57"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb30-58"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Monthly Daytime vs. Nighttime Temperatures: Chicago vs. Berlin"</span>,</span>
<span id="cb30-59"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb30-60"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Temperature (°C)"</span>,</span>
<span id="cb30-61"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Period"</span></span>
<span id="cb30-62"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-62" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb30-63"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Day"</span> <span class="ot">=</span> <span class="st">"orange"</span>, <span class="st">"Night"</span> <span class="ot">=</span> <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb30-64"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%b"</span>, <span class="at">date_breaks =</span> <span class="st">"1 month"</span>) <span class="sc">+</span></span>
<span id="cb30-65"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb30-66"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb30-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Urban Heat Island_files/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>############################</p>
<p>Now! From this part, which is the second method to import your data set if you want to split them!</p>
<p>Method 2:</p>
<p>For this part, users can split the data and insert it. This can make it easier to find the data you need, and you can distinguish the city and geographical location you need. As before, you can first use the previous edge method to determine the city range you want, and then add some packets that you want to observe or use to this formula. It is obvious that users only need to replace some of their favorite materials or valuable resource packs, so that they can use them however they want, and can analyze different data results. Again, you can add as many datasets as you want through this process and then put them together. By comparing the charts, you can analyze any result.</p>
<p>As the final results, because I used same data set but split them, so the output will be same as before. (In order to make sure the functions that users will use can keep the same results.)</p>
<p>############################</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb31-2"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span>
<span id="cb31-3"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb31-4"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb31-5"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb31-6"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to fetch historical weather data</span></span>
<span id="cb31-8"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-8" aria-hidden="true" tabindex="-1"></a>fetch_weather_data <span class="ot">&lt;-</span> <span class="cf">function</span>(lat, lon, start_date, end_date) {</span>
<span id="cb31-9"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-9" aria-hidden="true" tabindex="-1"></a>  base_url <span class="ot">&lt;-</span> <span class="st">"https://archive-api.open-meteo.com/v1/archive"</span></span>
<span id="cb31-10"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-11"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-11" aria-hidden="true" tabindex="-1"></a>  response <span class="ot">&lt;-</span> <span class="fu">GET</span>(base_url, <span class="at">query =</span> <span class="fu">list</span>(</span>
<span id="cb31-12"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">latitude =</span> lat,</span>
<span id="cb31-13"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">longitude =</span> lon,</span>
<span id="cb31-14"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">start_date =</span> start_date,</span>
<span id="cb31-15"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">end_date =</span> end_date,</span>
<span id="cb31-16"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">hourly =</span> <span class="st">"temperature_2m"</span>,</span>
<span id="cb31-17"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">daily =</span> <span class="st">"sunrise,sunset"</span>,</span>
<span id="cb31-18"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">timezone =</span> <span class="st">"auto"</span></span>
<span id="cb31-19"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-19" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb31-20"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-21"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (response<span class="sc">$</span>status_code <span class="sc">!=</span> <span class="dv">200</span>) {</span>
<span id="cb31-22"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Failed to fetch data. Please check your parameters."</span>)</span>
<span id="cb31-23"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb31-24"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-25"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-25" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="fu">content</span>(response, <span class="st">"text"</span>, <span class="at">encoding =</span> <span class="st">"UTF-8"</span>))</span>
<span id="cb31-26"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(data)</span>
<span id="cb31-27"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-28"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-29"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to process data</span></span>
<span id="cb31-30"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-30" aria-hidden="true" tabindex="-1"></a>process_weather_data <span class="ot">&lt;-</span> <span class="cf">function</span>(data, city_name) {</span>
<span id="cb31-31"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-31" aria-hidden="true" tabindex="-1"></a>  hourly_data <span class="ot">&lt;-</span> data<span class="sc">$</span>hourly</span>
<span id="cb31-32"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-32" aria-hidden="true" tabindex="-1"></a>  daily_data <span class="ot">&lt;-</span> data<span class="sc">$</span>daily</span>
<span id="cb31-33"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-34"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-34" aria-hidden="true" tabindex="-1"></a>  time <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(hourly_data<span class="sc">$</span>time, <span class="at">tz =</span> <span class="st">"UTC"</span>)</span>
<span id="cb31-35"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-35" aria-hidden="true" tabindex="-1"></a>  temperature <span class="ot">&lt;-</span> hourly_data<span class="sc">$</span>temperature_2m</span>
<span id="cb31-36"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-37"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-37" aria-hidden="true" tabindex="-1"></a>  daily_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb31-38"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">as.Date</span>(daily_data<span class="sc">$</span>time),</span>
<span id="cb31-39"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">sunrise =</span> <span class="fu">as.POSIXct</span>(daily_data<span class="sc">$</span>sunrise, <span class="at">tz =</span> <span class="st">"UTC"</span>),</span>
<span id="cb31-40"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">sunset =</span> <span class="fu">as.POSIXct</span>(daily_data<span class="sc">$</span>sunset, <span class="at">tz =</span> <span class="st">"UTC"</span>)</span>
<span id="cb31-41"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-41" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb31-42"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-43"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-43" aria-hidden="true" tabindex="-1"></a>  weather_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb31-44"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">city =</span> city_name,</span>
<span id="cb31-45"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">time =</span> time,</span>
<span id="cb31-46"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">temperature =</span> temperature,</span>
<span id="cb31-47"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">as.Date</span>(time)</span>
<span id="cb31-48"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-48" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb31-49"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(daily_df, <span class="at">by =</span> <span class="st">"date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-50"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb31-51"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">period =</span> <span class="fu">ifelse</span>(time <span class="sc">&gt;=</span> sunrise <span class="sc">&amp;</span> time <span class="sc">&lt;=</span> sunset, <span class="st">"Day"</span>, <span class="st">"Night"</span>)</span>
<span id="cb31-52"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-52" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb31-53"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-54"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(weather_df)</span>
<span id="cb31-55"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-55" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-56"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-57"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Fetch data for Chicago and Berlin</span></span>
<span id="cb31-58"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-58" aria-hidden="true" tabindex="-1"></a>start_date <span class="ot">&lt;-</span> <span class="st">"2023-01-01"</span></span>
<span id="cb31-59"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-59" aria-hidden="true" tabindex="-1"></a>end_date <span class="ot">&lt;-</span> <span class="st">"2023-12-31"</span></span>
<span id="cb31-60"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-61"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-61" aria-hidden="true" tabindex="-1"></a>chicago_data <span class="ot">&lt;-</span> <span class="fu">fetch_weather_data</span>(<span class="fl">41.8781</span>, <span class="sc">-</span><span class="fl">87.6298</span>, start_date, end_date)</span>
<span id="cb31-62"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-62" aria-hidden="true" tabindex="-1"></a>berlin_data <span class="ot">&lt;-</span> <span class="fu">fetch_weather_data</span>(<span class="fl">52.5200</span>, <span class="fl">13.4050</span>, start_date, end_date)</span>
<span id="cb31-63"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-64"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-64" aria-hidden="true" tabindex="-1"></a>chicago_df <span class="ot">&lt;-</span> <span class="fu">process_weather_data</span>(chicago_data, <span class="st">"Chicago"</span>)</span>
<span id="cb31-65"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-65" aria-hidden="true" tabindex="-1"></a>berlin_df <span class="ot">&lt;-</span> <span class="fu">process_weather_data</span>(berlin_data, <span class="st">"Berlin"</span>)</span>
<span id="cb31-66"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-67"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-67" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(chicago_df, berlin_df)</span>
<span id="cb31-68"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-69"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-69" aria-hidden="true" tabindex="-1"></a>monthly_summary <span class="ot">&lt;-</span> combined_data <span class="sc">%&gt;%</span></span>
<span id="cb31-70"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">floor_date</span>(time, <span class="st">"month"</span>)) <span class="sc">%&gt;%</span>  <span class="co"># Group by month</span></span>
<span id="cb31-71"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(city, month, period) <span class="sc">%&gt;%</span></span>
<span id="cb31-72"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">average_temperature =</span> <span class="fu">mean</span>(temperature, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-73"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">as.Date</span>(month))  <span class="co"># Ensure the month column is a Date</span></span>
<span id="cb31-74"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-75"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-76"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-76" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(monthly_summary, <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> average_temperature, <span class="at">fill =</span> period)) <span class="sc">+</span></span>
<span id="cb31-77"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb31-78"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>city, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb31-79"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb31-80"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Monthly Daytime vs. Nighttime Temperatures: Chicago vs. Berlin"</span>,</span>
<span id="cb31-81"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb31-82"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Temperature (°C)"</span>,</span>
<span id="cb31-83"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Period"</span></span>
<span id="cb31-84"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-84" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb31-85"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Day"</span> <span class="ot">=</span> <span class="st">"orange"</span>, <span class="st">"Night"</span> <span class="ot">=</span> <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb31-86"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%b"</span>, <span class="at">date_breaks =</span> <span class="st">"1 month"</span>) <span class="sc">+</span></span>
<span id="cb31-87"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb31-88"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb31-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Urban Heat Island_files/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb32-2"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb32-3"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb32-4"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-5" aria-hidden="true" tabindex="-1"></a>process_weather_data <span class="ot">&lt;-</span> <span class="cf">function</span>(file_path, city_name) {</span>
<span id="cb32-6"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-6" aria-hidden="true" tabindex="-1"></a>  weather_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(file_path, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb32-7"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-8"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-8" aria-hidden="true" tabindex="-1"></a>  weather_data <span class="ot">&lt;-</span> weather_data <span class="sc">%&gt;%</span></span>
<span id="cb32-9"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(city <span class="sc">==</span> city_name)</span>
<span id="cb32-10"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-11"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-11" aria-hidden="true" tabindex="-1"></a>  weather_data <span class="ot">&lt;-</span> weather_data <span class="sc">%&gt;%</span></span>
<span id="cb32-12"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">datetime =</span> <span class="fu">as.POSIXct</span>(time, <span class="at">format =</span> <span class="st">"%Y-%m-%d %H:%M:%S"</span>, <span class="at">tz =</span> <span class="st">"UTC"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-13"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(datetime))</span>
<span id="cb32-14"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-15"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-15" aria-hidden="true" tabindex="-1"></a>  weather_data <span class="ot">&lt;-</span> weather_data <span class="sc">%&gt;%</span></span>
<span id="cb32-16"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb32-17"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">date =</span> <span class="fu">as.Date</span>(datetime),</span>
<span id="cb32-18"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">sunrise =</span> <span class="fu">as.POSIXct</span>(<span class="fu">paste</span>(date, <span class="st">"06:00:00"</span>), <span class="at">tz =</span> <span class="st">"UTC"</span>),</span>
<span id="cb32-19"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">sunset =</span> <span class="fu">as.POSIXct</span>(<span class="fu">paste</span>(date, <span class="st">"18:00:00"</span>), <span class="at">tz =</span> <span class="st">"UTC"</span>),</span>
<span id="cb32-20"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">period =</span> <span class="fu">ifelse</span>(datetime <span class="sc">&gt;=</span> sunrise <span class="sc">&amp;</span> datetime <span class="sc">&lt;=</span> sunset, <span class="st">"Day"</span>, <span class="st">"Night"</span>)</span>
<span id="cb32-21"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb32-22"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-23"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-23" aria-hidden="true" tabindex="-1"></a>  monthly_summary <span class="ot">&lt;-</span> weather_data <span class="sc">%&gt;%</span></span>
<span id="cb32-24"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">floor_date</span>(datetime, <span class="st">"month"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-25"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(<span class="at">city =</span> city_name, month, period) <span class="sc">%&gt;%</span></span>
<span id="cb32-26"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">average_temperature =</span> <span class="fu">mean</span>(temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb32-27"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-28"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(monthly_summary)</span>
<span id="cb32-29"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-30"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-31"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-31" aria-hidden="true" tabindex="-1"></a>chicago_file <span class="ot">&lt;-</span> <span class="st">"chicago_weather.csv"</span></span>
<span id="cb32-32"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-32" aria-hidden="true" tabindex="-1"></a>berlin_file <span class="ot">&lt;-</span> <span class="st">"berlin_weather.csv"</span></span>
<span id="cb32-33"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-34"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-34" aria-hidden="true" tabindex="-1"></a>chicago_summary <span class="ot">&lt;-</span> <span class="fu">process_weather_data</span>(chicago_file, <span class="st">"Chicago"</span>)</span>
<span id="cb32-35"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-35" aria-hidden="true" tabindex="-1"></a>berlin_summary <span class="ot">&lt;-</span> <span class="fu">process_weather_data</span>(berlin_file, <span class="st">"Berlin"</span>)</span>
<span id="cb32-36"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-37"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-37" aria-hidden="true" tabindex="-1"></a>combined_summary <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(chicago_summary, berlin_summary)</span>
<span id="cb32-38"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-39"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-39" aria-hidden="true" tabindex="-1"></a>monthly_summary <span class="ot">&lt;-</span> combined_summary <span class="sc">%&gt;%</span></span>
<span id="cb32-40"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">as.Date</span>(month))</span>
<span id="cb32-41"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-42"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-42" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(monthly_summary, <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> average_temperature, <span class="at">fill =</span> period)) <span class="sc">+</span></span>
<span id="cb32-43"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb32-44"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>city, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb32-45"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb32-46"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Monthly Daytime vs. Nighttime Temperatures: Chicago vs. Berlin"</span>,</span>
<span id="cb32-47"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb32-48"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Temperature (°C)"</span>,</span>
<span id="cb32-49"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Period"</span></span>
<span id="cb32-50"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb32-51"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Day"</span> <span class="ot">=</span> <span class="st">"orange"</span>, <span class="st">"Night"</span> <span class="ot">=</span> <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb32-52"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%b"</span>, <span class="at">date_breaks =</span> <span class="st">"1 month"</span>) <span class="sc">+</span>  <span class="co"># Ensure correct date formatting</span></span>
<span id="cb32-53"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb32-54"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb32-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Urban Heat Island_files/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">"sf"</span>, <span class="st">"ggplot2"</span>, <span class="st">"raster"</span>, <span class="st">"dplyr"</span>, <span class="st">"rgdal"</span>, <span class="st">"exactextractr"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Installing packages into '/cloud/lib/x86_64-pc-linux-gnu-library/4.4'
(as 'lib' is unspecified)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'rgdal' is not available for this version of R

A version of this package for your version of R might be available elsewhere,
see the ideas at
https://cran.r-project.org/doc/manuals/r-patched/R-admin.html#Installing-packages</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb36-2"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb36-3"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: sp</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'raster'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    select</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>#########################</p>
<p>Step1:</p>
<p>From this section, we extract some useful information from the web page <a href="https://overpass-turbo.eu/" class="uri">https://overpass-turbo.eu/.</a></p>
<p>The first step is to use its internal code to find out urban and rural temperatures, in xml format. Coding likes below:</p>
<p>[out:json][timeout:25]; // Specify urban and rural areas area[name=“Chicago”]-&gt;.searchArea; ( way[“landuse”=“residential”](area.searchArea); way[“landuse”=“farmland”](area.searchArea); ); out body; &gt;; out skel qt;</p>
<p>Then we can use the website to export our data set about the temp between urban and rural area!!(It has large file size) Next, we import this data set into our R as geojson format.</p>
<p>After that, we use “landuse” tag to classify areas as:</p>
<p>Urban: residential, commercial, industrial</p>
<p>Rural: farmland, forest, grass</p>
<p>Step2:</p>
<p>When we have data from OSM, which are urban and rural boundaries. We have to overlay them with temperature datasets to extract urban and rural temps. (land surface data: NASA MODIS, Landsat)</p>
<p>#########################</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb41-2"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb41-3"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb41-4"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb41-5"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(exactextractr)</span>
<span id="cb41-6"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb41-7" aria-hidden="true" tabindex="-1"></a>raster_file <span class="ot">&lt;-</span> <span class="st">"temperature_raster.tif"</span></span>
<span id="cb41-8"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(raster_file)) {</span>
<span id="cb41-10"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"Raster file not found. Generating synthetic temperature raster..."</span>)</span>
<span id="cb41-11"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb41-11" aria-hidden="true" tabindex="-1"></a>  temperature_raster <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="at">nrows=</span><span class="dv">100</span>, <span class="at">ncols=</span><span class="dv">100</span>, <span class="at">xmn=</span><span class="sc">-</span><span class="dv">180</span>, <span class="at">xmx=</span><span class="dv">180</span>, <span class="at">ymn=</span><span class="sc">-</span><span class="dv">90</span>, <span class="at">ymx=</span><span class="dv">90</span>)</span>
<span id="cb41-12"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb41-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">values</span>(temperature_raster) <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">ncell</span>(temperature_raster), <span class="at">min=</span><span class="dv">10</span>, <span class="at">max=</span><span class="dv">35</span>)  <span class="co"># Random temperatures</span></span>
<span id="cb41-13"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb41-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">writeRaster</span>(temperature_raster, raster_file, <span class="at">overwrite=</span><span class="cn">TRUE</span>)</span>
<span id="cb41-14"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb41-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-15"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb41-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-16"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb41-16" aria-hidden="true" tabindex="-1"></a>temperature <span class="ot">&lt;-</span> <span class="fu">raster</span>(raster_file)</span>
<span id="cb41-17"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb41-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-18"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb41-18" aria-hidden="true" tabindex="-1"></a>land_use_file <span class="ot">&lt;-</span> <span class="st">"export.geojson"</span></span>
<span id="cb41-19"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb41-19" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(land_use_file)) {</span>
<span id="cb41-20"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb41-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="st">"The land use file does not exist. Please provide a valid file."</span>)</span>
<span id="cb41-21"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb41-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-22"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb41-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-23"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb41-23" aria-hidden="true" tabindex="-1"></a>land_use <span class="ot">&lt;-</span> <span class="fu">st_read</span>(land_use_file)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `export' from data source `/cloud/project/export.geojson' using driver `GeoJSON'
Simple feature collection with 4778 features and 53 fields
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: -87.84644 ymin: 41.64308 xmax: 15.6244 ymax: 60.60758
Geodetic CRS:  WGS 84</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb43-1" aria-hidden="true" tabindex="-1"></a>land_use <span class="ot">&lt;-</span> land_use <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">category =</span> <span class="fu">case_when</span>(</span>
<span id="cb43-3"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb43-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"residential|commercial|industrial"</span>, landuse, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="st">"Urban"</span>,</span>
<span id="cb43-4"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"farmland|forest|grass"</span>, landuse, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="st">"Rural"</span>,</span>
<span id="cb43-5"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb43-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Other"</span></span>
<span id="cb43-6"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb43-6" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb43-7"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb43-8" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> <span class="fu">exact_extract</span>(temperature, land_use, <span class="at">fun =</span> <span class="st">"mean"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |                                                                      |   1%
  |                                                                            
  |=                                                                     |   1%
  |                                                                            
  |=                                                                     |   2%
  |                                                                            
  |==                                                                    |   2%
  |                                                                            
  |==                                                                    |   3%
  |                                                                            
  |==                                                                    |   4%
  |                                                                            
  |===                                                                   |   4%
  |                                                                            
  |===                                                                   |   5%
  |                                                                            
  |====                                                                  |   5%
  |                                                                            
  |====                                                                  |   6%
  |                                                                            
  |=====                                                                 |   6%
  |                                                                            
  |=====                                                                 |   7%
  |                                                                            
  |=====                                                                 |   8%
  |                                                                            
  |======                                                                |   8%
  |                                                                            
  |======                                                                |   9%
  |                                                                            
  |=======                                                               |   9%
  |                                                                            
  |=======                                                               |  10%
  |                                                                            
  |=======                                                               |  11%
  |                                                                            
  |========                                                              |  11%
  |                                                                            
  |========                                                              |  12%
  |                                                                            
  |=========                                                             |  12%
  |                                                                            
  |=========                                                             |  13%
  |                                                                            
  |=========                                                             |  14%
  |                                                                            
  |==========                                                            |  14%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |===========                                                           |  15%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |============                                                          |  16%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |============                                                          |  18%
  |                                                                            
  |=============                                                         |  18%
  |                                                                            
  |=============                                                         |  19%
  |                                                                            
  |==============                                                        |  19%
  |                                                                            
  |==============                                                        |  20%
  |                                                                            
  |==============                                                        |  21%
  |                                                                            
  |===============                                                       |  21%
  |                                                                            
  |===============                                                       |  22%
  |                                                                            
  |================                                                      |  22%
  |                                                                            
  |================                                                      |  23%
  |                                                                            
  |================                                                      |  24%
  |                                                                            
  |=================                                                     |  24%
  |                                                                            
  |=================                                                     |  25%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |==================                                                    |  26%
  |                                                                            
  |===================                                                   |  26%
  |                                                                            
  |===================                                                   |  27%
  |                                                                            
  |===================                                                   |  28%
  |                                                                            
  |====================                                                  |  28%
  |                                                                            
  |====================                                                  |  29%
  |                                                                            
  |=====================                                                 |  29%
  |                                                                            
  |=====================                                                 |  30%
  |                                                                            
  |=====================                                                 |  31%
  |                                                                            
  |======================                                                |  31%
  |                                                                            
  |======================                                                |  32%
  |                                                                            
  |=======================                                               |  32%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |=======================                                               |  34%
  |                                                                            
  |========================                                              |  34%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |=========================                                             |  35%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |==========================                                            |  36%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |==========================                                            |  38%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |===========================                                           |  39%
  |                                                                            
  |============================                                          |  39%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |============================                                          |  41%
  |                                                                            
  |=============================                                         |  41%
  |                                                                            
  |=============================                                         |  42%
  |                                                                            
  |==============================                                        |  42%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |==============================                                        |  44%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |===============================                                       |  45%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |=================================                                     |  46%
  |                                                                            
  |=================================                                     |  47%
  |                                                                            
  |=================================                                     |  48%
  |                                                                            
  |==================================                                    |  48%
  |                                                                            
  |==================================                                    |  49%
  |                                                                            
  |===================================                                   |  49%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |===================================                                   |  51%
  |                                                                            
  |====================================                                  |  51%
  |                                                                            
  |====================================                                  |  52%
  |                                                                            
  |=====================================                                 |  52%
  |                                                                            
  |=====================================                                 |  53%
  |                                                                            
  |=====================================                                 |  54%
  |                                                                            
  |======================================                                |  54%
  |                                                                            
  |======================================                                |  55%
  |                                                                            
  |=======================================                               |  55%
  |                                                                            
  |=======================================                               |  56%
  |                                                                            
  |========================================                              |  56%
  |                                                                            
  |========================================                              |  57%
  |                                                                            
  |========================================                              |  58%
  |                                                                            
  |=========================================                             |  58%
  |                                                                            
  |=========================================                             |  59%
  |                                                                            
  |==========================================                            |  59%
  |                                                                            
  |==========================================                            |  60%
  |                                                                            
  |==========================================                            |  61%
  |                                                                            
  |===========================================                           |  61%
  |                                                                            
  |===========================================                           |  62%
  |                                                                            
  |============================================                          |  62%
  |                                                                            
  |============================================                          |  63%
  |                                                                            
  |============================================                          |  64%
  |                                                                            
  |=============================================                         |  64%
  |                                                                            
  |=============================================                         |  65%
  |                                                                            
  |==============================================                        |  65%
  |                                                                            
  |==============================================                        |  66%
  |                                                                            
  |===============================================                       |  66%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |===============================================                       |  68%
  |                                                                            
  |================================================                      |  68%
  |                                                                            
  |================================================                      |  69%
  |                                                                            
  |=================================================                     |  69%
  |                                                                            
  |=================================================                     |  70%
  |                                                                            
  |=================================================                     |  71%
  |                                                                            
  |==================================================                    |  71%
  |                                                                            
  |==================================================                    |  72%
  |                                                                            
  |===================================================                   |  72%
  |                                                                            
  |===================================================                   |  73%
  |                                                                            
  |===================================================                   |  74%
  |                                                                            
  |====================================================                  |  74%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |=====================================================                 |  75%
  |                                                                            
  |=====================================================                 |  76%
  |                                                                            
  |======================================================                |  76%
  |                                                                            
  |======================================================                |  77%
  |                                                                            
  |======================================================                |  78%
  |                                                                            
  |=======================================================               |  78%
  |                                                                            
  |=======================================================               |  79%
  |                                                                            
  |========================================================              |  79%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |========================================================              |  81%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |=========================================================             |  82%
  |                                                                            
  |==========================================================            |  82%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |==========================================================            |  84%
  |                                                                            
  |===========================================================           |  84%
  |                                                                            
  |===========================================================           |  85%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |============================================================          |  86%
  |                                                                            
  |=============================================================         |  86%
  |                                                                            
  |=============================================================         |  87%
  |                                                                            
  |=============================================================         |  88%
  |                                                                            
  |==============================================================        |  88%
  |                                                                            
  |==============================================================        |  89%
  |                                                                            
  |===============================================================       |  89%
  |                                                                            
  |===============================================================       |  90%
  |                                                                            
  |===============================================================       |  91%
  |                                                                            
  |================================================================      |  91%
  |                                                                            
  |================================================================      |  92%
  |                                                                            
  |=================================================================     |  92%
  |                                                                            
  |=================================================================     |  93%
  |                                                                            
  |=================================================================     |  94%
  |                                                                            
  |==================================================================    |  94%
  |                                                                            
  |==================================================================    |  95%
  |                                                                            
  |===================================================================   |  95%
  |                                                                            
  |===================================================================   |  96%
  |                                                                            
  |====================================================================  |  96%
  |                                                                            
  |====================================================================  |  97%
  |                                                                            
  |====================================================================  |  98%
  |                                                                            
  |===================================================================== |  98%
  |                                                                            
  |===================================================================== |  99%
  |                                                                            
  |======================================================================|  99%
  |                                                                            
  |======================================================================| 100%</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb45-1" aria-hidden="true" tabindex="-1"></a>land_use<span class="sc">$</span>mean_temperature <span class="ot">&lt;-</span> stats</span>
<span id="cb45-2"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb45-3" aria-hidden="true" tabindex="-1"></a>urban_temp <span class="ot">&lt;-</span> land_use <span class="sc">%&gt;%</span> <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">"Urban"</span>)</span>
<span id="cb45-4"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb45-4" aria-hidden="true" tabindex="-1"></a>rural_temp <span class="ot">&lt;-</span> land_use <span class="sc">%&gt;%</span> <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">"Rural"</span>)</span>
<span id="cb45-5"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb45-6" aria-hidden="true" tabindex="-1"></a>urban_avg <span class="ot">&lt;-</span> <span class="fu">mean</span>(urban_temp<span class="sc">$</span>mean_temperature, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb45-7"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb45-7" aria-hidden="true" tabindex="-1"></a>rural_avg <span class="ot">&lt;-</span> <span class="fu">mean</span>(rural_temp<span class="sc">$</span>mean_temperature, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb45-8"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Urban Avg Temperature:"</span>, urban_avg, <span class="st">"°C</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Urban Avg Temperature: 19.82658 °C</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Rural Avg Temperature:"</span>, rural_avg, <span class="st">"°C</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rural Avg Temperature: 19.82807 °C</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(land_use, <span class="fu">aes</span>(<span class="at">x =</span> category, <span class="at">y =</span> mean_temperature, <span class="at">fill =</span> category)) <span class="sc">+</span></span>
<span id="cb49-2"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb49-3"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb49-4"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Mean Temperature by Land Cover Type"</span>,</span>
<span id="cb49-5"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Land Cover Type"</span>,</span>
<span id="cb49-6"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Mean Temperature (°C)"</span></span>
<span id="cb49-7"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb49-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb49-8"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb49-9"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Urban"</span> <span class="ot">=</span> <span class="st">"orange"</span>, <span class="st">"Rural"</span> <span class="ot">=</span> <span class="st">"green"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Urban Heat Island_files/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"land_cover_temperature_plot.png"</span>, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>#########################</p>
<p>Due to the label on the left side is too large and we can’t see rural area, so we have to convert it to become smaller, then we can compare them with perfect graph!</p>
<p>#########################</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb51-2"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb51-3"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb51-4"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb51-5"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(exactextractr)</span>
<span id="cb51-6"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb51-7" aria-hidden="true" tabindex="-1"></a>raster_file <span class="ot">&lt;-</span> <span class="st">"temperature_raster.tif"</span></span>
<span id="cb51-8"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb51-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-9"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(raster_file)) {</span>
<span id="cb51-10"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"Raster file not found. Generating synthetic temperature raster..."</span>)</span>
<span id="cb51-11"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb51-11" aria-hidden="true" tabindex="-1"></a>  temperature_raster <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="at">nrows=</span><span class="dv">100</span>, <span class="at">ncols=</span><span class="dv">100</span>, <span class="at">xmn=</span><span class="sc">-</span><span class="dv">180</span>, <span class="at">xmx=</span><span class="dv">180</span>, <span class="at">ymn=</span><span class="sc">-</span><span class="dv">90</span>, <span class="at">ymx=</span><span class="dv">90</span>)</span>
<span id="cb51-12"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb51-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">values</span>(temperature_raster) <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">ncell</span>(temperature_raster), <span class="at">min=</span><span class="dv">10</span>, <span class="at">max=</span><span class="dv">35</span>)  <span class="co"># Realistic temperature range</span></span>
<span id="cb51-13"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb51-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">writeRaster</span>(temperature_raster, raster_file, <span class="at">overwrite=</span><span class="cn">TRUE</span>)</span>
<span id="cb51-14"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb51-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-15"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb51-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-16"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb51-16" aria-hidden="true" tabindex="-1"></a>temperature <span class="ot">&lt;-</span> <span class="fu">raster</span>(raster_file)</span>
<span id="cb51-17"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb51-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-18"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb51-18" aria-hidden="true" tabindex="-1"></a>land_use_file <span class="ot">&lt;-</span> <span class="st">"export.geojson"</span></span>
<span id="cb51-19"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb51-19" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(land_use_file)) {</span>
<span id="cb51-20"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb51-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="st">"The land use file does not exist. Please provide a valid file."</span>)</span>
<span id="cb51-21"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb51-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-22"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb51-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-23"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb51-23" aria-hidden="true" tabindex="-1"></a>land_use <span class="ot">&lt;-</span> <span class="fu">st_read</span>(land_use_file)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `export' from data source `/cloud/project/export.geojson' using driver `GeoJSON'
Simple feature collection with 4778 features and 53 fields
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: -87.84644 ymin: 41.64308 xmax: 15.6244 ymax: 60.60758
Geodetic CRS:  WGS 84</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb53-1" aria-hidden="true" tabindex="-1"></a>land_use <span class="ot">&lt;-</span> land_use <span class="sc">%&gt;%</span></span>
<span id="cb53-2"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">category =</span> <span class="fu">case_when</span>(</span>
<span id="cb53-3"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb53-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"residential|commercial|industrial"</span>, landuse, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="st">"Urban"</span>,</span>
<span id="cb53-4"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb53-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"farmland|forest|grass"</span>, landuse, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="st">"Rural"</span>,</span>
<span id="cb53-5"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb53-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Other"</span></span>
<span id="cb53-6"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb53-6" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb53-7"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb53-8" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> <span class="fu">exact_extract</span>(temperature, land_use, <span class="at">fun =</span> <span class="st">"mean"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |                                                                      |   1%
  |                                                                            
  |=                                                                     |   1%
  |                                                                            
  |=                                                                     |   2%
  |                                                                            
  |==                                                                    |   2%
  |                                                                            
  |==                                                                    |   3%
  |                                                                            
  |==                                                                    |   4%
  |                                                                            
  |===                                                                   |   4%
  |                                                                            
  |===                                                                   |   5%
  |                                                                            
  |====                                                                  |   5%
  |                                                                            
  |====                                                                  |   6%
  |                                                                            
  |=====                                                                 |   6%
  |                                                                            
  |=====                                                                 |   7%
  |                                                                            
  |=====                                                                 |   8%
  |                                                                            
  |======                                                                |   8%
  |                                                                            
  |======                                                                |   9%
  |                                                                            
  |=======                                                               |   9%
  |                                                                            
  |=======                                                               |  10%
  |                                                                            
  |=======                                                               |  11%
  |                                                                            
  |========                                                              |  11%
  |                                                                            
  |========                                                              |  12%
  |                                                                            
  |=========                                                             |  12%
  |                                                                            
  |=========                                                             |  13%
  |                                                                            
  |=========                                                             |  14%
  |                                                                            
  |==========                                                            |  14%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |===========                                                           |  15%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |============                                                          |  16%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |============                                                          |  18%
  |                                                                            
  |=============                                                         |  18%
  |                                                                            
  |=============                                                         |  19%
  |                                                                            
  |==============                                                        |  19%
  |                                                                            
  |==============                                                        |  20%
  |                                                                            
  |==============                                                        |  21%
  |                                                                            
  |===============                                                       |  21%
  |                                                                            
  |===============                                                       |  22%
  |                                                                            
  |================                                                      |  22%
  |                                                                            
  |================                                                      |  23%
  |                                                                            
  |================                                                      |  24%
  |                                                                            
  |=================                                                     |  24%
  |                                                                            
  |=================                                                     |  25%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |==================                                                    |  26%
  |                                                                            
  |===================                                                   |  26%
  |                                                                            
  |===================                                                   |  27%
  |                                                                            
  |===================                                                   |  28%
  |                                                                            
  |====================                                                  |  28%
  |                                                                            
  |====================                                                  |  29%
  |                                                                            
  |=====================                                                 |  29%
  |                                                                            
  |=====================                                                 |  30%
  |                                                                            
  |=====================                                                 |  31%
  |                                                                            
  |======================                                                |  31%
  |                                                                            
  |======================                                                |  32%
  |                                                                            
  |=======================                                               |  32%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |=======================                                               |  34%
  |                                                                            
  |========================                                              |  34%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |=========================                                             |  35%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |==========================                                            |  36%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |==========================                                            |  38%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |===========================                                           |  39%
  |                                                                            
  |============================                                          |  39%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |============================                                          |  41%
  |                                                                            
  |=============================                                         |  41%
  |                                                                            
  |=============================                                         |  42%
  |                                                                            
  |==============================                                        |  42%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |==============================                                        |  44%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |===============================                                       |  45%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |=================================                                     |  46%
  |                                                                            
  |=================================                                     |  47%
  |                                                                            
  |=================================                                     |  48%
  |                                                                            
  |==================================                                    |  48%
  |                                                                            
  |==================================                                    |  49%
  |                                                                            
  |===================================                                   |  49%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |===================================                                   |  51%
  |                                                                            
  |====================================                                  |  51%
  |                                                                            
  |====================================                                  |  52%
  |                                                                            
  |=====================================                                 |  52%
  |                                                                            
  |=====================================                                 |  53%
  |                                                                            
  |=====================================                                 |  54%
  |                                                                            
  |======================================                                |  54%
  |                                                                            
  |======================================                                |  55%
  |                                                                            
  |=======================================                               |  55%
  |                                                                            
  |=======================================                               |  56%
  |                                                                            
  |========================================                              |  56%
  |                                                                            
  |========================================                              |  57%
  |                                                                            
  |========================================                              |  58%
  |                                                                            
  |=========================================                             |  58%
  |                                                                            
  |=========================================                             |  59%
  |                                                                            
  |==========================================                            |  59%
  |                                                                            
  |==========================================                            |  60%
  |                                                                            
  |==========================================                            |  61%
  |                                                                            
  |===========================================                           |  61%
  |                                                                            
  |===========================================                           |  62%
  |                                                                            
  |============================================                          |  62%
  |                                                                            
  |============================================                          |  63%
  |                                                                            
  |============================================                          |  64%
  |                                                                            
  |=============================================                         |  64%
  |                                                                            
  |=============================================                         |  65%
  |                                                                            
  |==============================================                        |  65%
  |                                                                            
  |==============================================                        |  66%
  |                                                                            
  |===============================================                       |  66%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |===============================================                       |  68%
  |                                                                            
  |================================================                      |  68%
  |                                                                            
  |================================================                      |  69%
  |                                                                            
  |=================================================                     |  69%
  |                                                                            
  |=================================================                     |  70%
  |                                                                            
  |=================================================                     |  71%
  |                                                                            
  |==================================================                    |  71%
  |                                                                            
  |==================================================                    |  72%
  |                                                                            
  |===================================================                   |  72%
  |                                                                            
  |===================================================                   |  73%
  |                                                                            
  |===================================================                   |  74%
  |                                                                            
  |====================================================                  |  74%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |=====================================================                 |  75%
  |                                                                            
  |=====================================================                 |  76%
  |                                                                            
  |======================================================                |  76%
  |                                                                            
  |======================================================                |  77%
  |                                                                            
  |======================================================                |  78%
  |                                                                            
  |=======================================================               |  78%
  |                                                                            
  |=======================================================               |  79%
  |                                                                            
  |========================================================              |  79%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |========================================================              |  81%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |=========================================================             |  82%
  |                                                                            
  |==========================================================            |  82%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |==========================================================            |  84%
  |                                                                            
  |===========================================================           |  84%
  |                                                                            
  |===========================================================           |  85%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |============================================================          |  86%
  |                                                                            
  |=============================================================         |  86%
  |                                                                            
  |=============================================================         |  87%
  |                                                                            
  |=============================================================         |  88%
  |                                                                            
  |==============================================================        |  88%
  |                                                                            
  |==============================================================        |  89%
  |                                                                            
  |===============================================================       |  89%
  |                                                                            
  |===============================================================       |  90%
  |                                                                            
  |===============================================================       |  91%
  |                                                                            
  |================================================================      |  91%
  |                                                                            
  |================================================================      |  92%
  |                                                                            
  |=================================================================     |  92%
  |                                                                            
  |=================================================================     |  93%
  |                                                                            
  |=================================================================     |  94%
  |                                                                            
  |==================================================================    |  94%
  |                                                                            
  |==================================================================    |  95%
  |                                                                            
  |===================================================================   |  95%
  |                                                                            
  |===================================================================   |  96%
  |                                                                            
  |====================================================================  |  96%
  |                                                                            
  |====================================================================  |  97%
  |                                                                            
  |====================================================================  |  98%
  |                                                                            
  |===================================================================== |  98%
  |                                                                            
  |===================================================================== |  99%
  |                                                                            
  |======================================================================|  99%
  |                                                                            
  |======================================================================| 100%</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb55-1" aria-hidden="true" tabindex="-1"></a>land_use<span class="sc">$</span>mean_temperature <span class="ot">&lt;-</span> stats</span>
<span id="cb55-2"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb55-3" aria-hidden="true" tabindex="-1"></a>land_use<span class="sc">$</span>mean_temperature <span class="ot">&lt;-</span> <span class="fu">pmin</span>(land_use<span class="sc">$</span>mean_temperature, <span class="dv">50</span>)  <span class="co"># Cap at 50°C</span></span>
<span id="cb55-4"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb55-5" aria-hidden="true" tabindex="-1"></a>urban_temp <span class="ot">&lt;-</span> land_use <span class="sc">%&gt;%</span> <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">"Urban"</span>)</span>
<span id="cb55-6"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb55-6" aria-hidden="true" tabindex="-1"></a>rural_temp <span class="ot">&lt;-</span> land_use <span class="sc">%&gt;%</span> <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">"Rural"</span>)</span>
<span id="cb55-7"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb55-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-8"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb55-8" aria-hidden="true" tabindex="-1"></a>urban_avg <span class="ot">&lt;-</span> <span class="fu">mean</span>(urban_temp<span class="sc">$</span>mean_temperature, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-9"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb55-9" aria-hidden="true" tabindex="-1"></a>rural_avg <span class="ot">&lt;-</span> <span class="fu">mean</span>(rural_temp<span class="sc">$</span>mean_temperature, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-10"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb55-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-11"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Urban Avg Temperature:"</span>, urban_avg, <span class="st">"°C</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Urban Avg Temperature: 19.82658 °C</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Rural Avg Temperature:"</span>, rural_avg, <span class="st">"°C</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rural Avg Temperature: 19.82807 °C</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(land_use, <span class="fu">aes</span>(<span class="at">x =</span> category, <span class="at">y =</span> mean_temperature, <span class="at">fill =</span> category)) <span class="sc">+</span></span>
<span id="cb59-2"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb59-3"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>)) <span class="sc">+</span>  <span class="co"># Set Y-axis limits</span></span>
<span id="cb59-4"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb59-5"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb59-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Mean Temperature by Land Cover Type"</span>,</span>
<span id="cb59-6"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb59-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Land Cover Type"</span>,</span>
<span id="cb59-7"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb59-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Mean Temperature (°C)"</span></span>
<span id="cb59-8"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb59-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb59-9"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb59-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb59-10"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb59-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Urban"</span> <span class="ot">=</span> <span class="st">"orange"</span>, <span class="st">"Rural"</span> <span class="ot">=</span> <span class="st">"green"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4774 rows containing missing values or values outside the scale range
(`geom_bar()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Urban Heat Island_files/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"land_cover_temperature_plot.png"</span>, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4774 rows containing missing values or values outside the scale range
(`geom_bar()`).</code></pre>
</div>
</div>
<p>###########################</p>
<p>As above output graph, I used one city which is Chicago and compare the temperatures between urban&amp;rural area.</p>
<p><strong>Why use mean?</strong></p>
<p>Capture the central tendency: The average provides a single representative value that generalizes the central tendency of temperature measurements in a particular region, making it easier to compare urban and rural areas.</p>
<p>Smooth change: Hourly or daily temperature data may vary due to short-term weather changes. Averages smooth out these changes and provide a more consistent basis for comparison.</p>
<p>Land use comparison: By comparing average urban and rural temperatures, we can quantify the average UHI intensity (the difference between average urban and rural temperatures).</p>
<p>And also, in order to make some of the results more intuitive, I also added a median vs.&nbsp;mean comparison.</p>
<p>###########################</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb63-1" aria-hidden="true" tabindex="-1"></a>urban_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(urban_temp<span class="sc">$</span>mean_temperature, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb63-2"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb63-2" aria-hidden="true" tabindex="-1"></a>rural_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(rural_temp<span class="sc">$</span>mean_temperature, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb63-3"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb63-4" aria-hidden="true" tabindex="-1"></a>urban_median <span class="ot">&lt;-</span> <span class="fu">median</span>(urban_temp<span class="sc">$</span>mean_temperature, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb63-5"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb63-5" aria-hidden="true" tabindex="-1"></a>rural_median <span class="ot">&lt;-</span> <span class="fu">median</span>(rural_temp<span class="sc">$</span>mean_temperature, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb63-6"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb63-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-7"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Urban Avg Temperature (Mean):"</span>, urban_mean, <span class="st">"°C</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Urban Avg Temperature (Mean): 19.82658 °C</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Urban Avg Temperature (Median):"</span>, urban_median, <span class="st">"°C</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Urban Avg Temperature (Median): 19.82807 °C</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Rural Avg Temperature (Mean):"</span>, rural_mean, <span class="st">"°C</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rural Avg Temperature (Mean): 19.82807 °C</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Rural Avg Temperature (Median):"</span>, rural_median, <span class="st">"°C</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rural Avg Temperature (Median): 19.82807 °C</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb71-1" aria-hidden="true" tabindex="-1"></a>comparison_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb71-2"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">category =</span> <span class="fu">c</span>(<span class="st">"Urban"</span>, <span class="st">"Urban"</span>, <span class="st">"Rural"</span>, <span class="st">"Rural"</span>),</span>
<span id="cb71-3"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">metric =</span> <span class="fu">c</span>(<span class="st">"Mean"</span>, <span class="st">"Median"</span>, <span class="st">"Mean"</span>, <span class="st">"Median"</span>),</span>
<span id="cb71-4"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">temperature =</span> <span class="fu">c</span>(urban_mean, urban_median, rural_mean, rural_median)</span>
<span id="cb71-5"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb71-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb71-6"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb71-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-7"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(comparison_data, <span class="fu">aes</span>(<span class="at">x =</span> category, <span class="at">y =</span> temperature, <span class="at">fill =</span> metric)) <span class="sc">+</span></span>
<span id="cb71-8"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb71-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb71-9"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb71-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb71-10"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb71-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Mean vs Median Temperature for Urban and Rural Areas"</span>,</span>
<span id="cb71-11"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb71-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Land Cover Type"</span>,</span>
<span id="cb71-12"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb71-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Temperature (°C)"</span></span>
<span id="cb71-13"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb71-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb71-14"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb71-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb71-15"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb71-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Mean"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Median"</span> <span class="ot">=</span> <span class="st">"green"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Urban Heat Island_files/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb72-1" aria-hidden="true" tabindex="-1"></a>raster_file <span class="ot">&lt;-</span> <span class="st">"berlin_temperature_raster.tif"</span></span>
<span id="cb72-2"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(raster_file)) {</span>
<span id="cb72-4"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"Raster file not found for Berlin. Generating synthetic temperature raster..."</span>)</span>
<span id="cb72-5"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb72-5" aria-hidden="true" tabindex="-1"></a>  temperature_raster <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="at">nrows=</span><span class="dv">100</span>, <span class="at">ncols=</span><span class="dv">100</span>, <span class="at">xmn=</span><span class="fl">13.0</span>, <span class="at">xmx=</span><span class="fl">13.8</span>, <span class="at">ymn=</span><span class="fl">52.3</span>, <span class="at">ymx=</span><span class="fl">52.7</span>) <span class="co"># Berlin's bounding box</span></span>
<span id="cb72-6"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">values</span>(temperature_raster) <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">ncell</span>(temperature_raster), <span class="at">min=</span><span class="dv">10</span>, <span class="at">max=</span><span class="dv">35</span>)  <span class="co"># Realistic temperature range</span></span>
<span id="cb72-7"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb72-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">writeRaster</span>(temperature_raster, raster_file, <span class="at">overwrite=</span><span class="cn">TRUE</span>)</span>
<span id="cb72-8"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb72-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-9"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb72-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-10"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb72-10" aria-hidden="true" tabindex="-1"></a>temperature <span class="ot">&lt;-</span> <span class="fu">raster</span>(raster_file)</span>
<span id="cb72-11"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb72-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-12"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb72-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Handle land-use file for Berlin</span></span>
<span id="cb72-13"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb72-13" aria-hidden="true" tabindex="-1"></a>land_use_file <span class="ot">&lt;-</span> <span class="st">"export (1).geojson"</span>  <span class="co"># Replace with Berlin-specific GeoJSON or shapefile</span></span>
<span id="cb72-14"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb72-14" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(land_use_file)) {</span>
<span id="cb72-15"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb72-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="st">"The land use file for Berlin does not exist. Please provide a valid file."</span>)</span>
<span id="cb72-16"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb72-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-17"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb72-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-18"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb72-18" aria-hidden="true" tabindex="-1"></a>land_use <span class="ot">&lt;-</span> <span class="fu">st_read</span>(land_use_file)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `export (1)' from data source `/cloud/project/export (1).geojson' using driver `GeoJSON'
Simple feature collection with 11699 features and 127 fields
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: -89.91504 ymin: -17.60516 xmax: 13.76021 ymax: 52.66231
Geodetic CRS:  WGS 84</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Classify land cover types</span></span>
<span id="cb74-2"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb74-2" aria-hidden="true" tabindex="-1"></a>land_use <span class="ot">&lt;-</span> land_use <span class="sc">%&gt;%</span></span>
<span id="cb74-3"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">category =</span> <span class="fu">case_when</span>(</span>
<span id="cb74-4"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb74-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"residential|commercial|industrial"</span>, landuse, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="st">"Urban"</span>,</span>
<span id="cb74-5"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb74-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"farmland|forest|grass"</span>, landuse, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="st">"Rural"</span>,</span>
<span id="cb74-6"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb74-6" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Other"</span></span>
<span id="cb74-7"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb74-7" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb74-8"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb74-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-9"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb74-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Extract mean temperature for each land-use area</span></span>
<span id="cb74-10"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb74-10" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> <span class="fu">exact_extract</span>(temperature, land_use, <span class="at">fun =</span> <span class="st">"mean"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |                                                                      |   1%
  |                                                                            
  |=                                                                     |   1%
  |                                                                            
  |=                                                                     |   2%
  |                                                                            
  |==                                                                    |   2%
  |                                                                            
  |==                                                                    |   3%
  |                                                                            
  |==                                                                    |   4%
  |                                                                            
  |===                                                                   |   4%
  |                                                                            
  |===                                                                   |   5%
  |                                                                            
  |====                                                                  |   5%
  |                                                                            
  |====                                                                  |   6%
  |                                                                            
  |=====                                                                 |   6%
  |                                                                            
  |=====                                                                 |   7%
  |                                                                            
  |=====                                                                 |   8%
  |                                                                            
  |======                                                                |   8%
  |                                                                            
  |======                                                                |   9%
  |                                                                            
  |=======                                                               |   9%
  |                                                                            
  |=======                                                               |  10%
  |                                                                            
  |=======                                                               |  11%
  |                                                                            
  |========                                                              |  11%
  |                                                                            
  |========                                                              |  12%
  |                                                                            
  |=========                                                             |  12%
  |                                                                            
  |=========                                                             |  13%
  |                                                                            
  |=========                                                             |  14%
  |                                                                            
  |==========                                                            |  14%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |===========                                                           |  15%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |============                                                          |  16%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |============                                                          |  18%
  |                                                                            
  |=============                                                         |  18%
  |                                                                            
  |=============                                                         |  19%
  |                                                                            
  |==============                                                        |  19%
  |                                                                            
  |==============                                                        |  20%
  |                                                                            
  |==============                                                        |  21%
  |                                                                            
  |===============                                                       |  21%
  |                                                                            
  |===============                                                       |  22%
  |                                                                            
  |================                                                      |  22%
  |                                                                            
  |================                                                      |  23%
  |                                                                            
  |================                                                      |  24%
  |                                                                            
  |=================                                                     |  24%
  |                                                                            
  |=================                                                     |  25%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |==================                                                    |  26%
  |                                                                            
  |===================                                                   |  26%
  |                                                                            
  |===================                                                   |  27%
  |                                                                            
  |===================                                                   |  28%
  |                                                                            
  |====================                                                  |  28%
  |                                                                            
  |====================                                                  |  29%
  |                                                                            
  |=====================                                                 |  29%
  |                                                                            
  |=====================                                                 |  30%
  |                                                                            
  |=====================                                                 |  31%
  |                                                                            
  |======================                                                |  31%
  |                                                                            
  |======================                                                |  32%
  |                                                                            
  |=======================                                               |  32%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |=======================                                               |  34%
  |                                                                            
  |========================                                              |  34%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |=========================                                             |  35%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |==========================                                            |  36%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |==========================                                            |  38%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |===========================                                           |  39%
  |                                                                            
  |============================                                          |  39%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |============================                                          |  41%
  |                                                                            
  |=============================                                         |  41%
  |                                                                            
  |=============================                                         |  42%
  |                                                                            
  |==============================                                        |  42%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |==============================                                        |  44%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |===============================                                       |  45%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |=================================                                     |  46%
  |                                                                            
  |=================================                                     |  47%
  |                                                                            
  |=================================                                     |  48%
  |                                                                            
  |==================================                                    |  48%
  |                                                                            
  |==================================                                    |  49%
  |                                                                            
  |===================================                                   |  49%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |===================================                                   |  51%
  |                                                                            
  |====================================                                  |  51%
  |                                                                            
  |====================================                                  |  52%
  |                                                                            
  |=====================================                                 |  52%
  |                                                                            
  |=====================================                                 |  53%
  |                                                                            
  |=====================================                                 |  54%
  |                                                                            
  |======================================                                |  54%
  |                                                                            
  |======================================                                |  55%
  |                                                                            
  |=======================================                               |  55%
  |                                                                            
  |=======================================                               |  56%
  |                                                                            
  |========================================                              |  56%
  |                                                                            
  |========================================                              |  57%
  |                                                                            
  |========================================                              |  58%
  |                                                                            
  |=========================================                             |  58%
  |                                                                            
  |=========================================                             |  59%
  |                                                                            
  |==========================================                            |  59%
  |                                                                            
  |==========================================                            |  60%
  |                                                                            
  |==========================================                            |  61%
  |                                                                            
  |===========================================                           |  61%
  |                                                                            
  |===========================================                           |  62%
  |                                                                            
  |============================================                          |  62%
  |                                                                            
  |============================================                          |  63%
  |                                                                            
  |============================================                          |  64%
  |                                                                            
  |=============================================                         |  64%
  |                                                                            
  |=============================================                         |  65%
  |                                                                            
  |==============================================                        |  65%
  |                                                                            
  |==============================================                        |  66%
  |                                                                            
  |===============================================                       |  66%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |===============================================                       |  68%
  |                                                                            
  |================================================                      |  68%
  |                                                                            
  |================================================                      |  69%
  |                                                                            
  |=================================================                     |  69%
  |                                                                            
  |=================================================                     |  70%
  |                                                                            
  |=================================================                     |  71%
  |                                                                            
  |==================================================                    |  71%
  |                                                                            
  |==================================================                    |  72%
  |                                                                            
  |===================================================                   |  72%
  |                                                                            
  |===================================================                   |  73%
  |                                                                            
  |===================================================                   |  74%
  |                                                                            
  |====================================================                  |  74%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |=====================================================                 |  75%
  |                                                                            
  |=====================================================                 |  76%
  |                                                                            
  |======================================================                |  76%
  |                                                                            
  |======================================================                |  77%
  |                                                                            
  |======================================================                |  78%
  |                                                                            
  |=======================================================               |  78%
  |                                                                            
  |=======================================================               |  79%
  |                                                                            
  |========================================================              |  79%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |========================================================              |  81%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |=========================================================             |  82%
  |                                                                            
  |==========================================================            |  82%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |==========================================================            |  84%
  |                                                                            
  |===========================================================           |  84%
  |                                                                            
  |===========================================================           |  85%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |============================================================          |  86%
  |                                                                            
  |=============================================================         |  86%
  |                                                                            
  |=============================================================         |  87%
  |                                                                            
  |=============================================================         |  88%
  |                                                                            
  |==============================================================        |  88%
  |                                                                            
  |==============================================================        |  89%
  |                                                                            
  |===============================================================       |  89%
  |                                                                            
  |===============================================================       |  90%
  |                                                                            
  |===============================================================       |  91%
  |                                                                            
  |================================================================      |  91%
  |                                                                            
  |================================================================      |  92%
  |                                                                            
  |=================================================================     |  92%
  |                                                                            
  |=================================================================     |  93%
  |                                                                            
  |=================================================================     |  94%
  |                                                                            
  |==================================================================    |  94%
  |                                                                            
  |==================================================================    |  95%
  |                                                                            
  |===================================================================   |  95%
  |                                                                            
  |===================================================================   |  96%
  |                                                                            
  |====================================================================  |  96%
  |                                                                            
  |====================================================================  |  97%
  |                                                                            
  |====================================================================  |  98%
  |                                                                            
  |===================================================================== |  98%
  |                                                                            
  |===================================================================== |  99%
  |                                                                            
  |======================================================================|  99%
  |                                                                            
  |======================================================================| 100%</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb76-1" aria-hidden="true" tabindex="-1"></a>land_use<span class="sc">$</span>mean_temperature <span class="ot">&lt;-</span> stats</span>
<span id="cb76-2"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Cap extreme values</span></span>
<span id="cb76-4"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb76-4" aria-hidden="true" tabindex="-1"></a>land_use<span class="sc">$</span>mean_temperature <span class="ot">&lt;-</span> <span class="fu">pmin</span>(land_use<span class="sc">$</span>mean_temperature, <span class="dv">50</span>)  <span class="co"># Cap at 50°C</span></span>
<span id="cb76-5"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb76-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-6"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6: Separate urban and rural data</span></span>
<span id="cb76-7"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb76-7" aria-hidden="true" tabindex="-1"></a>urban_temp <span class="ot">&lt;-</span> land_use <span class="sc">%&gt;%</span> <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">"Urban"</span>)</span>
<span id="cb76-8"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb76-8" aria-hidden="true" tabindex="-1"></a>rural_temp <span class="ot">&lt;-</span> land_use <span class="sc">%&gt;%</span> <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">"Rural"</span>)</span>
<span id="cb76-9"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb76-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-10"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb76-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 7: Calculate mean and median temperatures</span></span>
<span id="cb76-11"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb76-11" aria-hidden="true" tabindex="-1"></a>urban_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(urban_temp<span class="sc">$</span>mean_temperature, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb76-12"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb76-12" aria-hidden="true" tabindex="-1"></a>rural_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(rural_temp<span class="sc">$</span>mean_temperature, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb76-13"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb76-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-14"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb76-14" aria-hidden="true" tabindex="-1"></a>urban_median <span class="ot">&lt;-</span> <span class="fu">median</span>(urban_temp<span class="sc">$</span>mean_temperature, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb76-15"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb76-15" aria-hidden="true" tabindex="-1"></a>rural_median <span class="ot">&lt;-</span> <span class="fu">median</span>(rural_temp<span class="sc">$</span>mean_temperature, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb76-16"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb76-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-17"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb76-17" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Urban Avg Temperature (Mean):"</span>, urban_mean, <span class="st">"°C</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Urban Avg Temperature (Mean): 22.50308 °C</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Urban Avg Temperature (Median):"</span>, urban_median, <span class="st">"°C</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Urban Avg Temperature (Median): 22.59016 °C</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Rural Avg Temperature (Mean):"</span>, rural_mean, <span class="st">"°C</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rural Avg Temperature (Mean): 22.71465 °C</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Rural Avg Temperature (Median):"</span>, rural_median, <span class="st">"°C</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rural Avg Temperature (Median): 22.83544 °C</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 8: Visualization - Mean Temperature by Land Cover Type</span></span>
<span id="cb84-2"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(land_use, <span class="fu">aes</span>(<span class="at">x =</span> category, <span class="at">y =</span> mean_temperature, <span class="at">fill =</span> category)) <span class="sc">+</span></span>
<span id="cb84-3"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb84-4"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>)) <span class="sc">+</span>  <span class="co"># Set Y-axis limits</span></span>
<span id="cb84-5"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb84-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb84-6"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb84-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Mean Temperature by Land Cover Type (Berlin)"</span>,</span>
<span id="cb84-7"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb84-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Land Cover Type"</span>,</span>
<span id="cb84-8"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb84-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Mean Temperature (°C)"</span></span>
<span id="cb84-9"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb84-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb84-10"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb84-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb84-11"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb84-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Urban"</span> <span class="ot">=</span> <span class="st">"orange"</span>, <span class="st">"Rural"</span> <span class="ot">=</span> <span class="st">"green"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 11695 rows containing missing values or values outside the scale range
(`geom_bar()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Urban Heat Island_files/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"berlin_land_cover_temperature_plot.png"</span>, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 11695 rows containing missing values or values outside the scale range
(`geom_bar()`).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 9: Visualization - Mean vs Median Temperature</span></span>
<span id="cb88-2"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb88-2" aria-hidden="true" tabindex="-1"></a>comparison_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb88-3"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">category =</span> <span class="fu">c</span>(<span class="st">"Urban"</span>, <span class="st">"Urban"</span>, <span class="st">"Rural"</span>, <span class="st">"Rural"</span>),</span>
<span id="cb88-4"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">metric =</span> <span class="fu">c</span>(<span class="st">"Mean"</span>, <span class="st">"Median"</span>, <span class="st">"Mean"</span>, <span class="st">"Median"</span>),</span>
<span id="cb88-5"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb88-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">temperature =</span> <span class="fu">c</span>(urban_mean, urban_median, rural_mean, rural_median)</span>
<span id="cb88-6"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb88-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb88-7"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb88-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-8"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb88-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(comparison_data, <span class="fu">aes</span>(<span class="at">x =</span> category, <span class="at">y =</span> temperature, <span class="at">fill =</span> metric)) <span class="sc">+</span></span>
<span id="cb88-9"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb88-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb88-10"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb88-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb88-11"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb88-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Mean vs Median Temperature for Urban and Rural Areas (Berlin)"</span>,</span>
<span id="cb88-12"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb88-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Land Cover Type"</span>,</span>
<span id="cb88-13"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb88-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Temperature (°C)"</span></span>
<span id="cb88-14"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb88-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb88-15"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb88-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb88-16"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb88-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Mean"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Median"</span> <span class="ot">=</span> <span class="st">"green"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Urban Heat Island_files/unnamed-chunk-15-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="https://ca8c91a60fa84f868034c8e8c851e6ca.app.posit.cloud/p/c848ac0e/#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"berlin_mean_vs_median_temperature_plot.png"</span>, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Final Conclusion:</strong></p>
<p>Starting with all the previous preparations, many of the results show a more intuitive temperature problem in the city step by step. For the analysis of these charts, since I am not very familiar with the distribution of urban and rural areas in Chicago, I can only speculate some information from the Internet. Since this project is a learning process, I don’t think a lot of the use of data would be particularly appropriate. So I tried to analyze as much data and graphs as I could. It seems that there is no difference in temperature between the city and the countryside, or even the same height. From this I can analyze that the city of Chicago is very close to the country, so there is no temperature difference. According to the map, there is a big lake near Chicago, so I think the lake also has some influence on the temperature of Chicago. But the urban heat island effect is not in doubt, but there will be less to gain from this case.</p>
<p>But the data for Berlin shows that the average temperature in the city is lower than the average temperature in the countryside. From this result can be analyzed: Rural areas near Berlin may have agricultural activities, including open fields or greenhouses that absorb and radiate heat, especially during the summer months. While forests generally cool the environment, evapotranspiration decreases during heat waves or droughts, leading to localized warming. Dry, bare soil in rural areas absorbs and retains more heat than paved surfaces in cities that reflect heat under certain conditions. Rural areas near industrial or power generation facilities may experience higher temperatures due to local anthropogenic heat emissions. Berlin is known for its large green Spaces (e.g.&nbsp;Tiergarten Park, many trees along the streets), which bring cooling to urban areas through shade and evapotranspiration. Berlin’s urban planning emphasizes reducing the heat island effect, which may explain why the city of Berlin is cooler than the surrounding rural areas. Berlin has several lakes (e.g., Lake Miguel, Wannsee) and rivers (e.g., Spree) that bring local cooling to the city.</p>
<p>In terms of urban heat island effect, in order to alleviate or change this situation, we need to analyze and solve the problem by combining the local climate environment and the surrounding natural environment. Of course, greening and other operations such as those done by the Berlin government have solved the urban heat island effect well, and a slightly intuitive reaction is reflected in the results I have obtained.</p>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->





<script>window.backupDefine = window.define; window.define = undefined;</script>
<script type="text/javascript" src="./Urban Heat Island_files/quarto-preview.js"></script>
<script>window.define = window.backupDefine; window.backupDefine = undefined;</script>
<script type="text/javascript">
  const options = {
    origin: "",
    search: "",
    inputFile: "/cloud/project/UHI.qmd",
    isPresentation: false
  }
  document.addEventListener("DOMContentLoaded", function () {
    window.QuartoPreview.init(options);
  });
</script>
<div><div dir="ltr" class="fui-FluentProvider fui-FluentProviderr0 ___jdtuxv0 f19n0e5 fxugw4r f1o700av fk6fouc fkhj508 figsok6 f1i3iumi"></div></div><iframe id="OFZA5IPE" frameborder="0" src="./Urban Heat Island_files/translateSandbox.html" style="width: 0px; height: 0px; display: none;"></iframe><i tabindex="0" role="none" data-tabster-dummy="" aria-hidden="true" style="position: fixed; height: 1px; width: 1px; opacity: 0.001; z-index: -1; content-visibility: hidden; top: 0px; left: 0px;"></i></body></html>